window.__require=function e(t,a,n){function i(o,c){if(!a[o]){if(!t[o]){var s=o.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+o+"'")}}var g=a[o]={exports:{}};t[o][0].call(g.exports,function(e){return i(t[o][1][e]||e)},g,g.exports,e,t,a,n)}return a[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<n.length;o++)i(n[o]);return i}({GameRankingList:[function(e,t,a){"use strict";cc._RF.push(t,"34b20QtdFVHIoh0dQVctykC","GameRankingList");cc.Class({extends:cc.Component,properties:{newScrollViewContent:cc.Node,newPrefabRankItem:cc.Prefab},start:function(){var e=this;wx.onMessage(function(t){console.log("\u63a5\u6536\u4e3b\u57df\u53d1\u6765\u6d88\u606f\uff1a",t),0==t.messageType?e.removeChild():3==t.messageType?e.submitScore(t.MAIN_MENU_NUM,t.score):5==t.messageType||(7==t.messageType?e.fetchNewFriendData(t.MAIN_MENU_NUM):9==t.messageType?e.fetchWeekData(t):11==t.messageType&&e.fetchTotalData(t))})},fetchWeekData:function(e){console.log("GameRankingList, data => ",e);this.removeChild();var t=JSON.parse(e.data);if(t&&t.length>0){for(var a=0,n=0;n<t.length;n++){var i=t[n];if(0!==t[n].winCnt){var r=cc.instantiate(this.newPrefabRankItem);r.getComponent("NewRankItem").initServerData(n,i),this.newScrollViewContent.addChild(r),a++}}var o=110*a;console.log("ranking height = "+o),this.newScrollViewContent.height=o}},fetchTotalData:function(e){console.log("GameRankingList, data => ",e);this.removeChild();var t=JSON.parse(e.data);if(t&&t.length>0){for(var a=0,n=0;n<t.length;n++){var i=t[n];if(0!==t[n].winCnt){var r=cc.instantiate(this.newPrefabRankItem);r.getComponent("NewRankItem").initServerData(n,i),this.newScrollViewContent.addChild(r),a++}}var o=110*a;console.log("ranking height = "+o),this.newScrollViewContent.height=o}},submitScore:function(e,t){wx.getUserCloudStorage({keyList:[e],success:function(a){console.log("getUserCloudStorage","success",a),wx.setUserCloudStorage({KVDataList:[{key:e,value:""+t}],success:function(e){console.log("setUserCloudStorage","success",e)},fail:function(e){console.log("setUserCloudStorage","fail")},complete:function(e){console.log("setUserCloudStorage","ok")}})},fail:function(e){console.log("getUserCloudStorage","fail")},complete:function(e){console.log("getUserCloudStorage","ok")}})},removeChild:function(){this.newScrollViewContent.removeAllChildren()},fetchNewFriendData:function(e){console.log("start fetchNewFriendData");var t=this;t.removeChild(),wx.getUserInfo({openIdList:["selfOpenId"],success:function(a){console.log("success",a.data);a.data[0];wx.getFriendCloudStorage({keyList:[e],success:function(e){console.log("wx.getFriendCloudStorage success",e);var a=e.data;a.sort(function(e,t){return 0==e.KVDataList.length&&0==t.KVDataList.length?0:0==e.KVDataList.length?1:0==t.KVDataList.length?-1:t.KVDataList[0].value-e.KVDataList[0].value});for(var n=0,i=0;i<a.length;i++){var r=a[i];if(0!==(0!=r.KVDataList.length?r.KVDataList[0].value:0)){var o=cc.instantiate(t.newPrefabRankItem);o.getComponent("NewRankItem").init(i,r),t.newScrollViewContent.addChild(o),n++}}var c=110*n;console.log("ranking height = "+c),t.newScrollViewContent.height=c},fail:function(e){console.log("wx.getFriendCloudStorage fail",e)}})},fail:function(e){}})}}),cc._RF.pop()},{}],NewRankItem:[function(e,t,a){"use strict";cc._RF.push(t,"49f24NdB91ODaBJ/h+dmvnF","NewRankItem"),cc.Class({extends:cc.Component,name:"NewRankItem",properties:{rankSpriteNode:cc.Node,rankLabelNode:cc.Node,backSprite:cc.Sprite,rankSprite:cc.Sprite,pics:{default:[],type:[cc.SpriteFrame]},rankPics:{default:[],type:[cc.SpriteFrame]},rankLabel:cc.Label,avatarImgSprite:cc.Sprite,nickLabel:cc.Label,topScoreLabel:cc.Label},start:function(){},init:function(e,t){var a=t.avatarUrl,n=t.nickname,i=0!=t.KVDataList.length?t.KVDataList[0].value:0;this.backSprite.spriteFrame=e%2==0?this.pics[0]:this.pics[1],e<3?(this.rankSprite.spriteFrame=this.rankPics[e],this.rankLabelNode.active=!1):(this.rankSpriteNode.active=!1,this.rankLabel.string=(e+1).toString()),this.changeSpriteFrameWithServerUrlForWeb(this.avatarImgSprite,a+"?aaa=aa.jpg"),this.nickLabel.string=n,this.topScoreLabel.string=i.toString()},initServerData:function(e,t){var a=t.avatarUrl,n=t.nickname,i=t.winCnt;this.backSprite.spriteFrame=e%2==0?this.pics[0]:this.pics[1],e<3?(this.rankSprite.spriteFrame=this.rankPics[e],this.rankLabelNode.active=!1):(this.rankSpriteNode.active=!1,this.rankLabel.string=(e+1).toString()),this.changeSpriteFrameWithServerUrlForWeb(this.avatarImgSprite,a+"?aaa=aa.jpg"),this.nickLabel.string=n,this.topScoreLabel.string=i.toString()},changeSpriteFrameWithServerUrlForWeb:function(e,t){e&&cc.loader.load(t,function(t,a){var n=new cc.SpriteFrame;n.setTexture(a),e.spriteFrame=n})},createImage:function(e){var t=this;try{var a=wx.createImage();a.onload=function(){try{var e=new cc.Texture2D;e.initWithElement(a),e.handleLoadedTexture(),t.avatarImgSprite.spriteFrame=new cc.SpriteFrame(e)}catch(e){console.log(e),t.avatarImgSprite.node.active=!1}},a.src=e}catch(e){console.log(e),t.avatarImgSprite.node.active=!1}}}),cc._RF.pop()},{}]},{},["GameRankingList","NewRankItem"]);