window.__require=function e(n,t,o){function r(a,i){if(!t[a]){if(!n[a]){var s=a.split("/");if(s=s[s.length-1],!n[s]){var l="function"==typeof __require&&__require;if(!i&&l)return l(s,!0);if(c)return c(s,!0);throw new Error("Cannot find module '"+a+"'")}}var u=t[a]={exports:{}};n[a][0].call(u.exports,function(e){return r(n[a][1][e]||e)},u,u.exports,e,n,t,o)}return t[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({Alert:[function(e,n,t){"use strict";cc._RF.push(n,"68dbbG/WKJJjKeYM4qRzeUt","Alert");var o=e("Constants").RESOURCES,r={_alert:null,_detailLabel:null,_cancelButton:null,_quitButton:null,_enterButton:null,_enterCallBack:null,_animSpeed:.3,show:function(e,n,t,c){var a=this;void 0!=r._alert&&(r._alert=null),r._animSpeed=c||r._animSpeed,cc.loader.loadRes("prefabs/Alert",cc.Prefab,function(o,i){if(o)cc.error(o);else{var s=cc.instantiate(i);r._alert=s;var l=cc.callFunc(a.onFadeOutFinish,a),u=cc.callFunc(a.onFadeInFinish,a);a.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(r._animSpeed,255),cc.scaleTo(r._animSpeed,1)),u),a.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(r._animSpeed,0),cc.scaleTo(r._animSpeed,2)),l),r._detailLabel=cc.find("alertBackground/detailLabel",s).getComponent(cc.Label),r._cancelButton=cc.find("alertBackground/cancelButton",s),r._quitButton=cc.find("alertBackground/quitButton",s),r._enterButton=cc.find("alertBackground/enterButton",s),r._enterButton.on("click",a.onButtonClicked,a),r._quitButton.on("click",a.onButtonClicked,a),r._cancelButton.on("click",a.onButtonClicked,a),r._alert.parent=cc.find("Canvas"),a.startFadeIn(),a.configAlert(e,n,t,c)}}),a.configAlert=function(e,n,t,o){r._enterCallBack=n,r._detailLabel.string=e,t||void 0==t?r._cancelButton.active=!0:(r._cancelButton.active=!1,r._enterButton.x=0)},a.startFadeIn=function(){cc.eventManager.pauseTarget(r._alert,!0),r._alert.position=cc.p(0,0),r._alert.setScale(2),r._alert.opacity=0,r._alert.runAction(a.actionFadeIn)},a.startFadeOut=function(){cc.eventManager.pauseTarget(r._alert,!0),r._alert.runAction(a.actionFadeOut)},a.onFadeInFinish=function(){cc.eventManager.resumeTarget(r._alert,!0)},a.onFadeOutFinish=function(){a.onDestory()},a.onButtonClicked=function(e){a.playClickAudio(),"enterButton"==e.target.name&&r._enterCallBack&&r._enterCallBack(),a.startFadeOut()},a.onDestory=function(){r._alert.destroy(),r._enterCallBack=null,r._alert=null,r._detailLabel=null,r._cancelButton=null,r._enterButton=null,r._animSpeed=.3},a.playClickAudio=function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(o.click,cc.AudioClip))}}};n.exports={show:r.show};cc._RF.pop()},{Constants:"Constants"}],BagItem:[function(e,n,t){"use strict";cc._RF.push(n,"899b15rVMxKdYdWV4lzbrrD","BagItem");var o=e("Constants"),r=o.SHOP_ITEM_STATUS,c=o.SKIN_TYPE,a=o.CHESS_SKIN,i=o.RESOURCES,s=e("UnitTools"),l=o.CLOUD_URL,u=e("Common");cc.Class({extends:cc.Component,properties:{background:cc.Sprite,cost:cc.Node,costIcon:cc.Node,usingBg:cc.Node,nameBg:cc.Node,skin:cc.Node,_type:r.COIN,_cost:0,_skinUsing:!1,_skin:0},onLoad:function(){},refresh:function(){switch(this._type){case r.USING:this.usingBg.active=!0,this._skinUsing=!0;break;default:this.usingBg.active=!1,this._skinUsing=!1}switch(this._skin){case a.GREEN_DRAGON:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.green_dragon,cc.SpriteFrame));break;case a.CAT_MAGE:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.cat_mage,cc.SpriteFrame));break;case a.BLUE_SHEEP:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.blue_sheep,cc.SpriteFrame));break;case a.PURPLE_SHEEP:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.purple_sheep,cc.SpriteFrame))}this.skin.on("click",this.activate,this),this.usingBg.on("click",this.activate,this)},init:function(e,n){console.log(e,n);this._type=e,this._skin=n,this._type===r.USING&&(this._skinUsing=!0),this.refresh()},activate:function(){G.index.request({url:l+"/activeItem",method:"POST",data:{data:{itemType:c.CHESS,itemId:this._skin}},success:function(e){console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code?u.showSysError():0===e.data.code?G.bagManager.loadChessData():1===e.data.code&&u.showSysError()},fail:function(){u.showSysError()}})}}),cc._RF.pop()},{Common:"Common",Constants:"Constants",UnitTools:"UnitTools"}],BagManager:[function(e,n,t){"use strict";cc._RF.push(n,"0cd7cLAjZNDtJ75bX2Wuaib","BagManager");var o=e("Constants"),r=o.RESOURCES,c=o.CLOUD_URL,a=e("UnitTools"),i=e("CreatorHelper"),s=o.SHOP_ITEM_STATUS,l=o.SCENE,u=o.CHESS_SKIN,d=o.BOARD_SKIN;cc.Class({extends:cc.Component,properties:{bagContent:cc.Node,chess:cc.Prefab,board:cc.Prefab,chessTab:cc.Node,boardTab:cc.Node,chessTabLabel:cc.Node,boardTabLabel:cc.Node,closeBtn:cc.Node,_chessList:null,_boardList:null,coinNumber:cc.Label},onLoad:function(){G.currentScene=l.BAG;G.bagManager=this,this._chessList=[{itemId:u.GREEN_DRAGON,price:1e3},{itemId:u.CAT_MAGE,price:1e3},{itemId:u.BLUE_SHEEP,price:2e3},{itemId:u.PURPLE_SHEEP,price:2e3}],this._boardList=[{itemId:d.PURPLE,price:1e3}],this.loadChessData()},onBagClose:function(){cc.director.loadScene("shop")},onChessTabClick:function(){this.playClickAudio(),this.loadChessData()},onBoardTabClick:function(){this.playClickAudio(),this.loadBoardData()},playClickAudio:function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))},loadChessData:function(){var e=this;e.chess&&G.index.request({url:c+"/player",success:function(n){if(console.log(n),!a.isNullOrUndefined(n.data)&&0==n.data.code){var t=n.data.data;if(!a.isNullOrUndefined(t)){G.me=t,G.playerCache=!0,e.bagContent.removeAllChildren(),i.changeSpriteFrame(e.chessTab.getComponent(cc.Sprite),"textures/Bag/btn_wdwp_yellow_xz"),i.changeSpriteFrame(e.boardTab.getComponent(cc.Sprite),"textures/Bag/btn_wdwp_red"),i.changeSpriteFrame(e.chessTabLabel.getComponent(cc.Sprite),"textures/Bag/txt_wdwp_qizi"),i.changeSpriteFrame(e.boardTabLabel.getComponent(cc.Sprite),"textures/Bag/txt_wdwp_qipan2");var o=t.chesses,r=0;for(var c in e._chessList)for(var l in o)if(e._chessList[c].itemId===o[l].itemId){var u=cc.instantiate(e.chess);o[l].isActive?u.getComponent("BagItem").init(s.USING,e._chessList[c].itemId):u.getComponent("BagItem").init(s.OWNED,e._chessList[c].itemId),e.bagContent.addChild(u),r++}var d=r%4==0?0:1,h=parseInt(r/4)+d;console.log("row == "+h),e.bagContent.height=350*h,e.coinNumber.string=t.coin}}}})},loadBoardData:function(){var e=this;e.board&&G.index.request({url:c+"/player",success:function(n){if(console.log(n),!a.isNullOrUndefined(n.data)&&0==n.data.code){var t=n.data.data;if(!a.isNullOrUndefined(t)){G.me=t,G.playerCache=!0,e.bagContent.removeAllChildren(),i.changeSpriteFrame(e.chessTab.getComponent(cc.Sprite),"textures/Bag/btn_wdwp_red"),i.changeSpriteFrame(e.boardTab.getComponent(cc.Sprite),"textures/Bag/btn_wdwp_yellow_xz"),i.changeSpriteFrame(e.chessTabLabel.getComponent(cc.Sprite),"textures/Bag/txt_wdwp_qizi2"),i.changeSpriteFrame(e.boardTabLabel.getComponent(cc.Sprite),"textures/Bag/txt_wdwp_qipan");var o=t.boards,r=0;for(var c in e._boardList)for(var l in o)if(e._boardList[c].itemId===o[l].itemId){var u=cc.instantiate(e.board);o[l].isActive?u.getComponent("BigBagItem").init(s.USING,e._boardList[c].itemId):u.getComponent("BigBagItem").init(s.OWNED,e._boardList[c].itemId),e.bagContent.addChild(u),r++}}var d=r;console.log("row == "+d),e.bagContent.height=350*d,e.coinNumber.string=t.coin}}})}}),cc._RF.pop()},{Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],BigBagItem:[function(e,n,t){"use strict";cc._RF.push(n,"5efd5heX+1LeojcNCWUACkq","BigBagItem");var o=e("Constants"),r=o.SHOP_ITEM_STATUS,c=o.SKIN_TYPE,a=o.BOARD_SKIN,i=o.RESOURCES,s=e("UnitTools"),l=o.CLOUD_URL,u=e("Common"),d=e("CreatorHelper");cc.Class({extends:cc.Component,properties:{background:cc.Sprite,usingBg:cc.Node,activeBg:cc.Node,activeFont:cc.Node,title:cc.Node,skin:cc.Node,_type:r.COIN,_cost:0,_skinUsing:!1,_skin:0},onLoad:function(){},refresh:function(){switch(this._type){case r.USING:this.usingBg.active=!0,this._skinUsing=!0,d.changeSpriteFrame(this.activeFont.getComponent(cc.Sprite),"textures/Font/txt_qx");break;default:this.usingBg.active=!1,this._skinUsing=!1,d.changeSpriteFrame(this.activeFont.getComponent(cc.Sprite),"textures/Font/txt_sy")}switch(this._skin){case a.PURPLE:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.shop_wgbk,cc.SpriteFrame)),this.title.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.title_wgbk,cc.SpriteFrame))}this.skin.on("click",this.activate,this),this.activeBg.on("click",this.activate,this)},init:function(e,n,t){console.log(e,n,t);this._type=e,this._skin=n,this._type===r.USING&&(this._skinUsing=!0),this.refresh()},activate:function(){G.index.request({url:l+"/activeItem",method:"POST",data:{data:{itemType:c.BOARD,itemId:this._skin}},success:function(e){console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code?u.showSysError():0===e.data.code?G.bagManager.loadBoardData():1===e.data.code&&u.showSysError()},fail:function(){u.showSysError()}})}}),cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],BigShopItem:[function(e,n,t){"use strict";cc._RF.push(n,"cdbb78pcOBCVZryBgrbzaa9","BigShopItem");var o=e("Constants"),r=o.SHOP_ITEM_STATUS,c=o.SKIN_TYPE,a=o.BOARD_SKIN,i=o.RESOURCES,s=e("UnitTools"),l=o.CLOUD_URL,u=e("Alert"),d=e("Common"),h=e("CreatorHelper");cc.Class({extends:cc.Component,properties:{background:cc.Sprite,cost:cc.Node,costIcon:cc.Node,costBg:cc.Node,ownedBg:cc.Node,title:cc.Node,skin:cc.Node,_type:r.COIN,_cost:0,_skinOwned:!1,_skin:0},onLoad:function(){},refresh:function(){switch(this._type){case r.COIN:this.costBg.active=!0,this.ownedBg.active=!1,h.changeSpriteFrame(this.costIcon.getComponent(cc.Sprite),"textures/Shop/pic_jb"),this._skinOwned=!1;break;case r.DIAMOND:this.costBg.active=!0,this.ownedBg.active=!1,h.changeSpriteFrame(this.costIcon.getComponent(cc.Sprite),"textures/Shop/pic_zs"),this._skinOwned=!1;break;case r.OWNED:case r.USING:this.costBg.active=!1,this.ownedBg.active=!0,this._skinOwned=!0}switch(this._skin){case a.PURPLE:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.shop_wgbk,cc.SpriteFrame)),this.title.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.title_wgbk,cc.SpriteFrame))}this._skinOwned||(this.cost.getComponent(cc.Label).string=this._cost,this.skin.on("click",this.purchase,this),this.costBg.on("click",this.purchase,this))},init:function(e,n){console.log(e,n);this._type=e,this._skin=n,this._type!==r.OWNED&&this._type!==r.USING?(this._cost=cost,this._skinOwned=!1):this._skinOwned=!0,this.refresh()},purchase:function(){var e=this;u.show("\u786e\u8ba4\u8d2d\u4e70\u8be5\u76ae\u80a4\u5417\uff1f",function(){G.index.request({url:l+"/purchaseItem",method:"POST",data:{data:{itemType:c.BOARD,itemId:e._skin}},success:function(e){console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code?d.showSysError():0===e.data.data.code?G.shopManager.loadBoardData(1):1===e.data.data.code?u.show("\u91d1\u5e01\u4e0d\u8db3!",null,!1):2===e.data.data.code&&d.showSysError()},fail:function(){d.showSysError()}})},!0)}}),cc._RF.pop()},{Alert:"Alert",Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],ChessManager:[function(e,n,t){"use strict";cc._RF.push(n,"fd23biEYxBN7IoWrlheRQaR","ChessManager");var o=e("Constants"),r=o.CHESS_TYPE,c=o.STAND,a=o.GAME_STATE,i=o.GAME_TYPE,s=e("EventEmitter"),l=e("Robot"),u=o.CLOUD_URL,d=e("UnitTools"),h=o.RESOURCES;cc.Class({extends:cc.Component,properties:{COL:8,ROW:8,chessPrefab:cc.Prefab,chesses:[],events:null},playChessAudio:function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(h.chess,cc.AudioClip))},getChessMap:function(){for(var e=[],n=0;n<this.COL;n++){e[n]=[];for(var t=0;t<this.ROW;t++)switch(this.chesses[n][t].type){case r.BLACK:e[n][t]=1;break;case r.WHITE:e[n][t]=-1;break;default:e[n][t]=0}}return e},getNowColor:function(){return G.gameManager.getTurn()===c.BLACK?1:-1},onLoad:function(){var e=this;if(G.newGame){console.log("load a new game"),G.chessManager=e,e.chessWidth=e.node.width/e.COL;for(var n=0;n<e.COL;n++){e.chesses[n]=[];for(var t=0;t<e.ROW;t++){var o=cc.instantiate(e.chessPrefab);o.parent=e.node,o.width=e.chessWidth-5,o.height=e.chessWidth-5,o.position=cc.p(e.chessWidth/2+n*e.chessWidth,e.chessWidth/2+t*e.chessWidth);var a=o.getComponent("Chess");a.coor=cc.p(n,t),e.chesses[n][t]=a,e.addTouchEvent(a)}}e.chesses[3][3].type=r.BLACK,e.chesses[3][4].type=r.WHITE,e.chesses[4][4].type=r.BLACK,e.chesses[4][3].type=r.WHITE,e.events=new s,e.events.on("fallChess",function(n){if(G.gameType===i.ROBOT){var t=l(e.getChessMap(),e.getNowColor(),1);e.fallChess(e.chesses[t.x][t.y])}else{var o=G.gameManager.turn===c.BLACK?r.BLACK:r.WHITE;G.index.emit("FallChess",{chess:{type:o,coor:n.chess.coor}})}}),G.index.on("FallChess",function(n){console.log("index on fall chess, res =>",{res:n}),e.updateFallChess(n)}),console.log("init game success, start game."),G.gameManager.startGame(),G.preChessManager.showJudgeMoveAble(G.gameManager.turn)}else console.log("load an old game from server"),G.newGame=!0,G.index.request({url:u+"/game",success:function(n){if(console.log(n),!d.isNullOrUndefined(n.data)&&0==n.data.code){var t=n.data.data;if(!d.isNullOrUndefined(t)){var o=t.chesses,a=t.turn,u=t.blackScore,h=t.whiteScore;G.chessManager=e,e.chessWidth=e.node.width/e.COL;for(var p=0;p<e.COL;p++){e.chesses[p]=[];for(var g=0;g<e.ROW;g++){var f=cc.instantiate(e.chessPrefab);f.parent=e.node,f.width=e.chessWidth-5,f.height=e.chessWidth-5,f.position=cc.p(e.chessWidth/2+p*e.chessWidth,e.chessWidth/2+g*e.chessWidth);var m=f.getComponent("Chess");m.coor=cc.p(p,g),e.chesses[p][g]=m,0===o[p][g].type?e.chesses[p][g].type=r.BLACK:1===o[p][g].type&&(e.chesses[p][g].type=r.WHITE),e.addTouchEvent(e.chesses[p][g])}}e.events=new s,e.events.on("fallChess",function(n){if(G.gameType===i.ROBOT){var t=l(e.getChessMap(),e.getNowColor(),1);e.fallChess(e.chesses[t.x][t.y])}else{var o=G.gameManager.turn===c.BLACK?r.BLACK:r.WHITE;G.index.emit("FallChess",{chess:{type:o,coor:n.chess.coor}})}}),G.index.on("FallChess",function(n){console.log("index on fall chess, res =>",{res:n}),e.updateFallChess(n)}),console.log("init game success, start game."),G.gameManager.updateScoreByData(u,h),G.gameManager.startGameWithParams(0===a?c.BLACK:c.WHITE),G.preChessManager.showJudgeMoveAble(G.gameManager.turn)}}},fail:function(e){console.log(e)}})},addTouchEvent:function(e){var n=this;e.node.on("touchend",function(t){n.playChessAudio();var o=G.gameManager.gameState,c=G.gameManager.turn,s=G.stand;if(console.log("touchend, gameState, turn, stand =>",{gameState:o,turn:c,stand:s}),G.gameManager.gameState===a.PLAYING&&G.gameManager.turn===G.stand&&e.type===r.NONE)for(var l=1;l<=8;l++){if(n.judgePass(G.gameManager.turn,e,l)){n.fallChess(e),G.gameType===i.ROBOT?setTimeout(function(){n.events.emit("fallChess",{chess:e})},1e3):n.events.emit("fallChess",{chess:e});break}if(8===l)return}})},updateFallChess:function(e){if(this.playChessAudio(),!d.isNullOrUndefined(e.chess)){var n=0===e.chess.type?r.BLACK:r.WHITE,t=this.chesses[e.chess.coor.x][e.chess.coor.y];t.type=n;for(var o=1;o<=8;o++)this.judgePass(G.gameManager.turn,t,o)&&this.changePass(t,o)}G.gameManager.updateScoreByData(e.blackScore,e.whiteScore),0===e.state?G.gameManager.endServerGame():-2===e.state?G.gameManager.endServerGame():(0===e.turn?G.gameManager.turn==c.WHITE&&G.gameManager.changeTurn():G.gameManager.turn==c.BLACK&&G.gameManager.changeTurn(),G.preChessManager.hideJudgeMoveAble(),G.preChessManager.showJudgeMoveAble(G.gameManager.turn))},fallChess:function(e){if(this.playChessAudio(),G.gameType===i.ROBOT){G.gameManager.turn===c.BLACK?e.type=r.BLACK:G.gameManager.turn===c.WHITE&&(e.type=r.WHITE);for(var n=1;n<=8;n++)this.judgePass(G.gameManager.turn,e,n)&&this.changePass(e,n);G.gameManager.updateScore(),G.gameManager.changeTurn(),this.judgeWin()}},nearChess:function(e,n){switch(n){case 1:if(0!==e.coor.x)return this.chesses[e.coor.x-1][e.coor.y];break;case 2:if(0!==e.coor.x&&e.coor.y!==this.ROW-1)return this.chesses[e.coor.x-1][e.coor.y+1];break;case 3:if(e.coor.y!==this.ROW-1)return this.chesses[e.coor.x][e.coor.y+1];break;case 4:if(e.coor.x!==this.COL-1&&e.coor.y!==this.ROW-1)return this.chesses[e.coor.x+1][e.coor.y+1];break;case 5:if(e.coor.x!==this.COL-1)return this.chesses[e.coor.x+1][e.coor.y];break;case 6:if(e.coor.x!==this.COL-1&&0!==e.coor.y)return this.chesses[e.coor.x+1][e.coor.y-1];break;case 7:if(0!==e.coor.y)return this.chesses[e.coor.x][e.coor.y-1];break;case 8:if(0!==e.coor.x&&0!==e.coor.y)return this.chesses[e.coor.x-1][e.coor.y-1]}return null},judgePass:function(e,n,t){var o=n;if(null===(o=this.nearChess(n,t)))return!1;for(;o.type===-e;){if(null===(o=this.nearChess(o,t)))return!1;if(o.type==e)return!0}return!1},changePass:function(e,n){for(var t=this.nearChess(e,n);t.type===-G.gameManager.turn;)t.type=e.type,t=this.nearChess(t,n)},judgeMoveAble:function(e){for(var n=null,t=0;t<this.COL;t++)for(var o=0;o<this.ROW;o++)if((n=this.chesses[t][o]).type===r.NONE)for(var c=1;c<=8;c++)if(this.judgePass(e,n,c))return!0;return!1},judgeWin:function(){var e=this,n=e.judgeMoveAble(G.gameManager.turn),t=e.judgeMoveAble(-G.gameManager.turn);if(n)return G.preChessManager.hideJudgeMoveAble(),void G.preChessManager.showJudgeMoveAble(G.gameManager.turn);!n&&t?(cc.log("can not move next turn"),G.gameManager.forceChangeTurn(),G.preChessManager.hideJudgeMoveAble(),G.preChessManager.showJudgeMoveAble(G.gameManager.turn),G.gameType===i.ROBOT&&setTimeout(function(){e.events.emit("fallChess",{})},1e3)):n||t||(cc.log("both can not move someone win"),G.gameManager.endGame())},getChessCount:function(){for(var e=0,n=0,t=0;t<this.chesses.length;t++)for(var o=0;o<this.chesses[t].length;o++)this.chesses[t][o].type===r.BLACK?e++:this.chesses[t][o].type===r.WHITE&&n++;return[e,n]}}),cc._RF.pop()},{Constants:"Constants",EventEmitter:"EventEmitter",Robot:"Robot",UnitTools:"UnitTools"}],Chess:[function(e,n,t){"use strict";cc._RF.push(n,"038ecKdx7hAFbMdQrCbLy4q","Chess");var o=e("Constants"),r=o.CHESS_TYPE,c=(o.RESOURCES,e("Common"));cc.Class({extends:cc.Component,properties:{pics:{default:[],type:[cc.SpriteFrame]},black:cc.SpriteFrame,white:cc.SpriteFrame,_type:r.NONE,_lastType:r.NONE,type:{get:function(){return this._type},set:function(e){this._lastType=this._type,this._type=e,e===r.BLACK?this._lastType===r.WHITE?this.turnOver():this.getComponent(cc.Sprite).spriteFrame=this.black:e===r.WHITE?this._lastType===r.BLACK?this.turnOver():this.getComponent(cc.Sprite).spriteFrame=this.white:this.getComponent(cc.Sprite).spriteFrame=null}},coor:cc.p(0,0)},turnOver:function(){this.node.rotationX=0,this.node.rotationY=0;var e=cc.rotateTo(.5,0,180);this.node.runAction(e),this.node.scaleX=-1},update:function(e){this.node.rotationY>90?this._lastType===r.WHITE?this.getComponent(cc.Sprite).spriteFrame=this.black:this._lastType===r.BLACK&&(this.getComponent(cc.Sprite).spriteFrame=this.white):this._lastType===r.WHITE?this.getComponent(cc.Sprite).spriteFrame=this.white:this._lastType===r.BLACK&&(this.getComponent(cc.Sprite).spriteFrame=this.black)},onLoad:function(){this.black=new cc.SpriteFrame(cc.loader.getRes(c.getBlackChessSkin(),cc.SpriteFrame)),this.white=new cc.SpriteFrame(cc.loader.getRes(c.getWhiteChessSkin(),cc.SpriteFrame)),this.type=r.NONE,this._lastType=r.NONE}}),cc._RF.pop()},{Common:"Common",Constants:"Constants"}],Common:[function(e,n,t){"use strict";cc._RF.push(n,"c45b5AdPhtDx5GcPi+Ok5Ai","Common");var o=e("Alert"),r=e("UnitTools"),c=e("Constants"),a=c.GAME_TYPE,i=c.CHESS_SKIN,s=c.BOARD_SKIN,l=c.STAND,u=c.RESOURCES,d=c.SCENE;function h(){return G.gameType===a.ROBOT?g(G.me,l.BLACK):G.stand===l.BLACK?g(G.me,l.BLACK):g(G.opponent,l.BLACK)}function p(){return G.gameType===a.ROBOT?null:G.stand===l.WHITE?g(G.me,l.WHITE):g(G.opponent,l.WHITE)}function g(e,n){if(r.isNullOrUndefined(e))return null;var t=e.chesses;if(!r.isNullOrUndefined(t))for(var o in t)if(t[o].isActive){if(console.log("player skin => ",t[o]),console.log("stand => ",n),console.log("mod => ",t[o].itemId%2),n===l.BLACK&&t[o].itemId%2==1)return t[o].itemId;if(n===l.WHITE&&t[o].itemId%2==0)return t[o].itemId}return null}n.exports={showSysError:function(){o.show("\u7a0b\u5e8f\u5458\u5c0f\u54e5\u54e5\u6b63\u5728\u62a2\u4fee~",null,!1)},showClearError:function(){o.show("\u6218\u573a\u6b63\u5728\u6e05\u7406\u4e2d\uff0c\u8bf7\u7a0d\u540e\uff01",null,!1)},showFutureError:function(){o.show("\u656c\u8bf7\u671f\u5f85\uff01",null,!1)},onShown:function(e){console.log("onShown => ",{res:e}),console.log("onShown, G.currentScene => "+G.currentScene),console.log("onShown, G.index.isActive() => "+G.index.isActive()),console.log("onShown, G.index.isClosed() => "+G.index.isClosed()),console.log("onShown, G.index.isConnecting() => "+G.index.isConnecting()),console.log("onShown, G.index.isReconnecting() => "+G.index.isReconnecting()),r.isNullOrUndefined(G.currentScene)||G.currentScene===d.LOADING?cc.director.loadScene("load-game"):(r.isNullOrUndefined(e.query.roomId)?G.queryRoomId=null:G.queryRoomId=e.query.roomId,G.index.emit("reconnect",{}),G.index.isActive()?r.isNullOrUndefined(e.query.roomId)||(console.log("System Start JoinGame"),G.index.emit("JoinGame",{roomId:e.query.roomId})):cc.director.loadScene("menu"))},getBoardSkin:function(){if(r.isNullOrUndefined(G.me))return u.bord_1;var e=G.me.boards;if(!r.isNullOrUndefined(e))for(var n in e)if(e[n].isActive)switch(e[n].itemId){case s.PURPLE:return u.bord_2;default:return u.bord_1}return u.bord_1},getBlackHeadSkin:function(){var e=h();if(r.isNullOrUndefined(e))return u.red_dragon_head;switch(e){case i.GREEN_DRAGON:return u.green_dragon_head;case i.BLUE_SHEEP:return u.blue_sheep_score;default:return u.red_dragon_head}},getWhiteHeadSkin:function(){var e=p();if(r.isNullOrUndefined(e))return u.cat_knight_head;switch(e){case i.CAT_MAGE:return u.cat_mage_head;case i.PURPLE_SHEEP:return u.purple_sheep_score;default:return u.cat_knight_head}},getBlackChessSkin:function(){var e=h();if(r.isNullOrUndefined(e))return u.chess_red_dragon;switch(e){case i.GREEN_DRAGON:return u.chess_green_dragon;case i.BLUE_SHEEP:return u.blue_sheep_head;default:return u.chess_red_dragon}},getWhiteChessSkin:function(){var e=p();if(r.isNullOrUndefined(e))return u.chess_cat_knight;switch(e){case i.CAT_MAGE:return u.chess_cat_mage;case i.PURPLE_SHEEP:return u.purple_sheep_head;default:return u.chess_cat_knight}},showShareCoinSuccess:function(){o.show("\u9886\u53d6\u6210\u529f\uff01",null,!1)},showUseShareKeySuccess:function(){o.show("\u4f7f\u7528\u6210\u529f\uff01",null,!1)}},cc._RF.pop()},{Alert:"Alert",Constants:"Constants",UnitTools:"UnitTools"}],Constants:[function(e,n,t){"use strict";cc._RF.push(n,"12eb7dOVPtKGbYm/iRgXp8a","Constants");var o=cc.Enum({BLACK:47,WHITE:-47}),r=cc.Enum({NONE:-1,BLACK:47,WHITE:-47}),c=cc.Enum({NONE:0,DISCONNECT:1,SETTLEMENT:2,ROBOT:3}),a=cc.Enum({NONE:0,DISCONNECT:1,WIN:2,LOSE:3}),i=cc.Enum({PREPARE:-1,PLAYING:-1,OVER:-1}),s=cc.Enum({RANK:-1,MATCH:-1,ROBOT:-1,FRIEND:-1}),l=cc.Enum({LEFT:-1,LEFT_UP:-1,UP:-1,RIGHT_UP:-1,RIGHT:-1,RIGHT_DOWN:-1,DOWN:-1,LEFT_DOWN:-1}),u=cc.Enum({IN_HALL:"IN_HALL",MATCHING:"MATCHING",GAME_PREPARE:"GAME_PREPARE",MATCH_SUCCESS:"MATCH_SUCCESS",IN_GAME:"IN_GAME",SETTLEMENT:"SETTLEMENT"}),d=cc.Enum({LOADING:"LOADING",MENU:"MENU",GAME:"GAME",SHOP:"SHOP",BAG:"BAG"}),h=cc.Enum({CHESS:-1,BOARD:-1}),p=cc.Enum({WIN:3,LOSS:0,DRAW:1}),g=cc.Enum({FRIEND:1,START:2,WAITING:3}),f=cc.Enum({COIN:-1,DIAMOND:-1,OWNED:-1,USING:-1}),m=cc.Enum({CHESS:"chesses",BOARD:"boards"}),_=cc.Enum({GREEN_DRAGON:1,CAT_MAGE:2,PURPLE_SHEEP:3,BLUE_SHEEP:4}),S=cc.Enum({DEFAULT:1,PURPLE:2}),C="https://lg-m9ctlz8m-1256663606.cos.ap-shanghai.myqcloud.com/ayanami/",T=cc.Enum({bord_1:C+"bord-1.jpg",bord_2:C+"bord_2.jpg",image_left:C+"image_left_2.png",image_middle:C+"image_middle_2.png",image_right:C+"image_right_2.png",blue_light:C+"blue_light.png",cat_knight_head:C+"cat_knight_head.png",cat_mage_head:C+"cat_mage_head.png",green_dragon_head:C+"green_dragon_head.png",red_dragon_head:C+"red_dragon_head.png",red_light:C+"red_light.png",rope:C+"rope.png",cat_knight:C+"cat_knight.png",cat_mage:C+"cat_mage.png",green_dragon:C+"green_dragon.png",red_dragon:C+"red_dragon.png",kuang_1:C+"kuang1.png",kuang_2:C+"kuang2.png",frame:C+"frame.png",chess_cat_knight:C+"chess_cat_knight.png",chess_cat_mage:C+"chess_cat_mage.png",chess_green_dragon:C+"chess_green_dragon.png",chess_red_dragon:C+"chess_red_dragon.png",curtain:C+"curtain.png",bgm:C+"bgm-2.mp3",click:C+"click.mp3",countDown:C+"countDown.mp3",chess:C+"chess.mp3",coin:C+"coin.png",diamond:C+"diamond.png",owned:C+"owned.png",using:C+"using.png",blue_sheep:C+"blue_sheep.png",purple_sheep:C+"purple_sheep.png",blue_sheep_head:C+"blue_sheep_head.png",purple_sheep_head:C+"purple_sheep_head.png",blue_sheep_score:C+"blue_sheep_socre.png",purple_sheep_score:C+"purple_sheep_score.png",hall_bg:C+"hall-bg.png",share_1:C+"share-1.jpg",chess_common_bg:C+"chess_common_bg.png",chess_owned_bg:C+"chess_owned_bg.png",gray_cat_mage:C+"gray_cat_mage.png",gray_green_dragon:C+"gray_green_dragon.png",gray_blue_sheep:C+"gray_blue_sheep.png",gray_purple_sheep:C+"gray_purple_sheep.png",name_cat_mage:C+"name_cat_mage.png",name_green_dragon:C+"name_green_dragon.png",name_blue_sheep:C+"name_blue_sheep.png",name_purple_sheep:C+"name_purple_sheep.png",shop_wgbk:C+"shop_wgbk.png",title_wgbk:C+"title_wgbk.png"});n.exports={STAND:o,CHESS_TYPE:r,GAME_STATE:i,DIR:l,CLOUD_URL:"https://71yjnssv.qcloud.la/weapp",GAME_TYPE:s,SERVER_PLAYER_STATE:u,SCENE:d,INFO_TYPE:c,TITLE_TYPE:a,SERVER_GAME_RESULT:p,CONFIRM_BUTTON_FONT:g,COS_URL:C,RESOURCES:T,SHOP_ACTIVE_TAB:h,SHOP_ITEM_STATUS:f,SKIN_TYPE:m,CHESS_SKIN:_,BOARD_SKIN:S},cc._RF.pop()},{}],CreatorHelper:[function(e,n,t){"use strict";function o(){}cc._RF.push(n,"b461bSKxTVL05j0vWf15z2R","CreatorHelper"),o.getNodeComponent=function(e,n){return e.getComponent(n)},o.createNewSpriteNode=function(){return(new cc.Node).addComponent(cc.Sprite)},o.touchInSprite=function(e,n){var t=n.convertToNodeSpace(e.getLocation()),o=n.getContentSize(),r=cc.rect(0,0,o.width,o.height);return!!cc.rectContainsPoint(r,t)},o.setNodeClickEvent=function(e,n){e.on(cc.Node.EventType.TOUCH_END,function(){n(e)},e)},o.setNodeClickEventWithContent=function(e,n,t){e.on(cc.Node.EventType.TOUCH_END,function(){t(e)},n)},o.setPressEvent=function(e,n){e.on(cc.Node.EventType.TOUCH_START,function(){n(e)},e)},o.setUnPressEvent=function(e,n){e.on(cc.Node.EventType.TOUCH_END,function(){n(e)},e)},o.setCancelEvent=function(e,n){e.on(cc.Node.EventType.TOUCH_CANCEL,function(){n(e)},e)},o.setMoveEvent=function(e,n){e.on(cc.Node.EventType.TOUCH_MOVE,function(t){n(e,t)},e)},o.changeFixedSpriteFrame=function(e,n){cc.loader.loadRes(n,cc.SpriteFrame,function(n,t){var o=e.node.width,r=e.node.height;e.spriteFrame=t,e.node.width=o,e.node.height=r})},o.changeSpriteFrame=function(e,n){cc.loader.loadRes(n,cc.SpriteFrame,function(n,t){e.spriteFrame=t})},o.loadAllAudio=function(e,n){cc.loader.loadResAll(e,cc.AudioClip,function(e,t){var o={};for(var r in t){var c=t[r];o[c.name]=c,n(o)}})},o.getRealPath=function(e){return cc.url.raw(e)},o.changeSpriteFrameWithServerUrl=function(e,n){cc.sys.isNative,o.changeSpriteFrameWithServerUrlForWeb(e,n)},o.changeSpriteFrameWithServerUrlForWeb=function(e,n){e&&cc.loader.load(n,function(t,r){if(t)setTimeout(function(){o.changeSpriteFrameWithServerUrl(e,n)},1e3);else{var c=new cc.SpriteFrame;c.setTexture(r),e.spriteFrame=c}})},o.changeSpriteFrameWithServerUrlForNative=function(n,t){var r=e("MD5"),c=jsb.fileUtils.getWritablePath()+"/ServerImages/",a=c+r(t)+".png";function i(){cc.loader.load(a,function(e,t){if(e)cc.error(e);else{var o=new cc.SpriteFrame(t);o&&(n.spriteFrame=o)}})}cc.log("\u5b58\u50a8\u5730\u5740\u662f"+a);if(jsb.fileUtils.isFileExist(a))return cc.log("Remote is find"+a),void i();var s=new XMLHttpRequest;s.onreadystatechange=function(){cc.log("xhr.readyState  "+s.readyState),cc.log("xhr.status  "+s.status),4===s.readyState&&(200===s.status?s.responseType="arraybuffer":setTimeout(function(){o.changeSpriteFrameWithServerUrlForNative(n,t)},1e3))}.bind(this),s.open("GET",t,!0),s.send()},o.screenShoot=function(e){if(cc.sys.isNative){var n=jsb.fileUtils.getWritablePath()+"ScreenShoot/";jsb.fileUtils.isDirectoryExist(n)||jsb.fileUtils.createDirectory(n);var t="ScreenShoot-"+(new Date).valueOf()+".png",o=n+t,r=cc.director.getVisibleSize(),c=cc.RenderTexture.create(r.width,r.height);cc.director.getScene()._sgNode.addChild(c),c.setVisible(!1),c.begin(),cc.director.getScene()._sgNode.visit(),c.end(),cc.log(c.saveToFile.length),c.saveToFile("ScreenShoot/"+t,cc.IMAGE_FORMAT_PNG,!0,function(){cc.log("save succ"),cc.log(o),c.removeFromParent(),e&&e(o)})}},n.exports=o,cc._RF.pop()},{MD5:"MD5"}],EventEmitter:[function(e,n,t){"use strict";cc._RF.push(n,"91195QWL/VNbICejHcQ6srY","EventEmitter");var o=e("UnitTools");function r(){this.events={}}r.prototype.on=function(e,n){(o.hasKey(this.events,e)?this.events[e]:this.events[e]=[]).push(n)},r.prototype.emit=function(e){var n=Array.prototype.slice.call(arguments,1,arguments.length);o.forEach(this.events[e],function(e,t){t.apply(t,n)})},r.prototype.remove=function(e){var n=this,t={};for(var r in this.events){var c=this.events[r];for(var a in c){var i=c[a];i==e&&o.getOrCreateArrayInJson(r,t).push(i)}}o.forEach(t,function(t,r){o.removeArray(n.events[t],[e])})},r.prototype.off=function(e){this.remove(e)},r.prototype.removeEvent=function(e){o.remove(this.events,e)},n.exports=r,cc._RF.pop()},{UnitTools:"UnitTools"}],GameManager:[function(e,n,t){"use strict";cc._RF.push(n,"e993eESIzFLR5rQMdFCiYnH","GameManager");var o=e("Constants"),r=o.GAME_STATE,c=o.GAME_TYPE,a=o.STAND,i=e("Alert"),s=o.SCENE,l=o.CLOUD_URL,u=e("Common"),d=o.RESOURCES,h=e("ShowInfo"),p=o.INFO_TYPE,g=o.SERVER_GAME_RESULT,f=e("CreatorHelper"),m=e("UnitTools");cc.Class({extends:cc.Component,properties:{gameState:{default:r.PREPARE,type:r},turn:{default:a.BLACK,type:a},blackScoreLabel:cc.Label,whiteScoreLabel:cc.Label,blackScoreSprite:cc.Sprite,whiteScoreSprite:cc.Sprite,blackTimerSprite:cc.Node,whiteTimerSprite:cc.Node,blackHeadFrame:cc.Node,whiteHeadFrame:cc.Node,blackHeadSprite:cc.Node,whiteHeadSprite:cc.Node,board:cc.Sprite,leftCurtain:cc.Node,rightCurtain:cc.Node},playClickAudio:function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(d.click,cc.AudioClip))},loadScene:function(e){var n=this;n.leftCurtain.active=!0,n.rightCurtain.active=!0,console.log(this.leftCurtain);var t=cc.moveTo(e,cc.p(-779.5,0)),o=cc.moveTo(e,cc.p(779.5,0));n.leftCurtain.runAction(cc.sequence(t,cc.callFunc(function(){n.leftCurtain.active=!1}))),n.rightCurtain.runAction(cc.sequence(o,cc.callFunc(function(){n.rightCurtain.active=!1})))},onLoad:function(){G.gameManager=this,G.currentScene=s.GAME,this.leftCurtain.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(d.curtain,cc.SpriteFrame)),this.rightCurtain.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(d.curtain,cc.SpriteFrame)),this.blackScoreSprite.spriteFrame=new cc.SpriteFrame(cc.loader.getRes(u.getBlackHeadSkin(),cc.SpriteFrame)),this.whiteScoreSprite.spriteFrame=new cc.SpriteFrame(cc.loader.getRes(u.getWhiteHeadSkin(),cc.SpriteFrame)),this.blackTimerSprite.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(d.red_light,cc.SpriteFrame)),this.whiteTimerSprite.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(d.blue_light,cc.SpriteFrame)),this.board.spriteFrame=new cc.SpriteFrame(cc.loader.getRes(u.getBoardSkin(),cc.SpriteFrame)),G.stand===a.BLACK?(this.blackHeadFrame.active=!0,this.blackHeadSprite.active=!0,this.whiteHeadFrame.active=!1,this.whiteHeadSprite.active=!1,f.changeSpriteFrameWithServerUrl(this.blackHeadSprite.getComponent(cc.Sprite),G.me.avatarUrl+"?aaa=aa.jpg"),G.gameType===c.ROBOT||m.isNullOrUndefined(G.opponent)||(this.whiteHeadSprite.active=!0,this.whiteHeadFrame.active=!0,f.changeSpriteFrameWithServerUrl(this.whiteHeadSprite.getComponent(cc.Sprite),G.opponent.avatarUrl+"?aaa=aa.jpg"))):(this.blackHeadFrame.active=!1,this.blackHeadSprite.active=!1,this.whiteHeadFrame.active=!0,this.whiteHeadSprite.active=!0,f.changeSpriteFrameWithServerUrl(this.whiteHeadSprite.getComponent(cc.Sprite),G.me.avatarUrl+"?aaa=aa.jpg"),G.gameType===c.ROBOT||m.isNullOrUndefined(G.opponent)||(this.blackHeadSprite.active=!0,this.blackHeadFrame.active=!0,f.changeSpriteFrameWithServerUrl(this.blackHeadSprite.getComponent(cc.Sprite),G.opponent.avatarUrl+"?aaa=aa.jpg"))),this.blackTimerSprite.active=!1,this.whiteTimerSprite.active=!1,this.turnTime=3e4},start:function(){this.loadScene(1)},startGame:function(){this.turn=a.BLACK,this.blackTimerSprite.active=!0,this.gameState=r.PLAYING,this.showInfo("start game"),G.gameType!==c.ROBOT&&this.startServerGame()},startGameWithParams:function(e){this.turn=e,this.turn===a.BLACK?this.blackTimerSprite.active=!0:this.whiteTimerSprite.active=!0,this.gameState=r.PLAYING,this.showInfo("start game"),G.gameType!==c.ROBOT&&this.startServerGame()},startServerGame:function(){var e=this;G.index.on("TimeLeft",function(n){n.timeLeft<=e.turnTime&&(e.blackTimerSprite.active?e.blackTimerSprite.getComponent(cc.Sprite).fillRange=1-n.timeLeft/e.turnTime:e.whiteTimerSprite.active&&(e.whiteTimerSprite.getComponent(cc.Sprite).fillRange=1-n.timeLeft/e.turnTime))})},endGame:function(){this.gameState=r.OVER,this.showInfo("game over")},endServerGame:function(){this.gameState=r.OVER,this.showInfo("game over")},getTurn:function(){return this.turn},changeTurn:function(){this.gameState===r.PLAYING&&(this.turn===a.BLACK?(this.turn=a.WHITE,this.blackTimerSprite.active=!1,this.whiteTimerSprite.getComponent(cc.Sprite).fillRange=1,this.whiteTimerSprite.active=!0):this.turn===a.WHITE&&(this.turn=a.BLACK,this.blackTimerSprite.getComponent(cc.Sprite).fillRange=1,this.blackTimerSprite.active=!0,this.whiteTimerSprite.active=!1))},forceChangeTurn:function(){this.showInfo("force change turn"),this.changeTurn()},updateScore:function(){var e=G.chessManager.getChessCount(),n=e[0],t=e[1];this.blackScoreLabel.string=n+"",this.whiteScoreLabel.string=t+""},updateScoreByData:function(e,n){this.blackScoreLabel.string=e+"",this.whiteScoreLabel.string=n+""},showInfo:function(e){var n=G.chessManager.getChessCount(),t=n[0],o=n[1];if("start game"===e)G.stand===a.BLACK?i.show("\u4f60\u83b7\u5f97\u4e86\u5148\u624b\uff0c\u731b\u9f99!",null,!1):G.stand===a.WHITE&&i.show("\u4f60\u83b7\u5f97\u4e86\u540e\u624b\uff0c\u52c7\u58eb!",null,!1);else if("game over"===e)if(G.gameType!==c.ROBOT)h.show(p.SETTLEMENT,function(){G.currentScene!==s.MENU&&cc.director.loadScene("menu")});else{var r=new Object;t>o?r.result=g.WIN:t<o?r.result=g.LOSS:t===o&&(r.result=g.DRAW),r.score=t,r.rb_score=o,console.log("rb_settlement =>",r),h.show(p.ROBOT,function(){G.currentScene!==s.MENU&&cc.director.loadScene("menu")},r)}else if("force change turn"===e);else if("surrender"===e)if(t=0,G.gameType!==c.ROBOT)h.show(p.SETTLEMENT,function(){G.currentScene!==s.MENU&&cc.director.loadScene("menu")});else{r=new Object;t>o?r.result=g.WIN:t<o?r.result=g.LOSS:t===o&&(r.result=g.DRAW),r.score=t,r.rb_score=o,console.log("rb_settlement =>",r),h.show(p.ROBOT,function(){G.currentScene!==s.MENU&&cc.director.loadScene("menu")},r)}},surrender:function(){var e=this;e.playClickAudio(),e.gameState=r.OVER,G.gameType===c.ROBOT?i.show("\u786e\u8ba4\u6295\u964d\u5417",function(){e.showInfo("surrender")},!0):i.show("\u786e\u8ba4\u6295\u964d\u5417",function(){e.severSurrender()},!0)},severSurrender:function(){var e=this;G.index.request({url:l+"/surrender",method:"POST",success:function(n){console.log(n),0==n.data.code&&e.showInfo("surrender")},fail:function(){u.showSysError()}})}}),cc._RF.pop()},{Alert:"Alert",Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",ShowInfo:"ShowInfo",UnitTools:"UnitTools"}],Global:[function(e,n,t){"use strict";cc._RF.push(n,"04fd0MxwapHrYsfCAT2HRS8","Global"),window.G={index:null,roomId:null,gameManager:null,menuManager:null,chessManager:null,preChessManager:null,shopManager:null,bagManager:null,stand:0,hasLogin:!1,me:null,opponent:null,gameType:null,currentScene:null,newGame:!0,gameId:"reversi_2333",gameShareId:"reversi_share_2333",playerCache:!1,music:!0,queryRoomId:null},cc._RF.pop()},{}],LoadManager:[function(e,n,t){"use strict";cc._RF.push(n,"60529tI/TJP+rEHdM2ut8sw","LoadManager");var o=e("Constants"),r=o.RESOURCES,c=e("Common"),a=o.SCENE;cc.Class({extends:cc.Component,properties:{progressBar:{default:null,type:cc.ProgressBar},laodBg:{default:null,type:cc.Node}},onLoad:function(){G.currentScene=a.LOADING,this._urls=[r.bord_1,r.bord_2,r.blue_light,r.cat_knight_head,r.cat_mage_head,r.green_dragon_head,r.red_dragon_head,r.red_light,r.cat_knight,r.cat_mage,r.green_dragon,r.red_dragon,r.kuang_1,r.kuang_2,r.frame,r.chess_cat_knight,r.chess_cat_mage,r.chess_green_dragon,r.chess_red_dragon,r.curtain,r.bgm,r.click,r.chess,r.coin,r.diamond,r.using,r.owned,r.blue_sheep,r.purple_sheep,r.blue_sheep_head,r.purple_sheep_head,r.blue_sheep_score,r.purple_sheep_score,r.gray_blue_sheep,r.gray_cat_mage,r.gray_green_dragon,r.gray_purple_sheep,r.chess_common_bg,r.chess_owned_bg,r.shop_wgbk,r.title_wgbk],this.resource=null,this.progressBar.progress=0,this._clearAll(),this.resource||cc.loader.load(this._urls,this._progressCallback.bind(this),this._completeCallback.bind(this)),wx.onShow(c.onShown)},_clearAll:function(){for(var e=0;e<this._urls.length;++e){var n=this._urls[e];cc.loader.release(n)}},_progressCallback:function(e,n,t){this.progress=e/n,this.resource=t,this.completedCount=e,this.totalCount=n},_completeCallback:function(e,n){setTimeout(function(){cc.director.loadScene("menu")},1500)},update:function(e){if(this.resource){var n=this.progressBar.progress;n>=1||(n<this.progress&&(n+=e),this.progressBar.progress=n)}}}),cc._RF.pop()},{Common:"Common",Constants:"Constants"}],MD5:[function(e,n,t){"use strict";cc._RF.push(n,"0ac03XWV9ZOuZYGShJ3GVGr","MD5");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,n){var t=(65535&e)+(65535&n);return(e>>16)+(n>>16)+(t>>16)<<16|65535&t}function c(e,n,t,o,c,a){return r(function(e,n){return e<<n|e>>>32-n}(r(r(n,e),r(o,a)),c),t)}function a(e,n,t,o,r,a,i){return c(n&t|~n&o,e,n,r,a,i)}function i(e,n,t,o,r,a,i){return c(n&o|t&~o,e,n,r,a,i)}function s(e,n,t,o,r,a,i){return c(n^t^o,e,n,r,a,i)}function l(e,n,t,o,r,a,i){return c(t^(n|~o),e,n,r,a,i)}function u(e,n){var t,o,c,u,d;e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var h=1732584193,p=-271733879,g=-1732584194,f=271733878;for(t=0;t<e.length;t+=16)o=h,c=p,u=g,d=f,p=l(p=l(p=l(p=l(p=s(p=s(p=s(p=s(p=i(p=i(p=i(p=i(p=a(p=a(p=a(p=a(p,g=a(g,f=a(f,h=a(h,p,g,f,e[t],7,-680876936),p,g,e[t+1],12,-389564586),h,p,e[t+2],17,606105819),f,h,e[t+3],22,-1044525330),g=a(g,f=a(f,h=a(h,p,g,f,e[t+4],7,-176418897),p,g,e[t+5],12,1200080426),h,p,e[t+6],17,-1473231341),f,h,e[t+7],22,-45705983),g=a(g,f=a(f,h=a(h,p,g,f,e[t+8],7,1770035416),p,g,e[t+9],12,-1958414417),h,p,e[t+10],17,-42063),f,h,e[t+11],22,-1990404162),g=a(g,f=a(f,h=a(h,p,g,f,e[t+12],7,1804603682),p,g,e[t+13],12,-40341101),h,p,e[t+14],17,-1502002290),f,h,e[t+15],22,1236535329),g=i(g,f=i(f,h=i(h,p,g,f,e[t+1],5,-165796510),p,g,e[t+6],9,-1069501632),h,p,e[t+11],14,643717713),f,h,e[t],20,-373897302),g=i(g,f=i(f,h=i(h,p,g,f,e[t+5],5,-701558691),p,g,e[t+10],9,38016083),h,p,e[t+15],14,-660478335),f,h,e[t+4],20,-405537848),g=i(g,f=i(f,h=i(h,p,g,f,e[t+9],5,568446438),p,g,e[t+14],9,-1019803690),h,p,e[t+3],14,-187363961),f,h,e[t+8],20,1163531501),g=i(g,f=i(f,h=i(h,p,g,f,e[t+13],5,-1444681467),p,g,e[t+2],9,-51403784),h,p,e[t+7],14,1735328473),f,h,e[t+12],20,-1926607734),g=s(g,f=s(f,h=s(h,p,g,f,e[t+5],4,-378558),p,g,e[t+8],11,-2022574463),h,p,e[t+11],16,1839030562),f,h,e[t+14],23,-35309556),g=s(g,f=s(f,h=s(h,p,g,f,e[t+1],4,-1530992060),p,g,e[t+4],11,1272893353),h,p,e[t+7],16,-155497632),f,h,e[t+10],23,-1094730640),g=s(g,f=s(f,h=s(h,p,g,f,e[t+13],4,681279174),p,g,e[t],11,-358537222),h,p,e[t+3],16,-722521979),f,h,e[t+6],23,76029189),g=s(g,f=s(f,h=s(h,p,g,f,e[t+9],4,-640364487),p,g,e[t+12],11,-421815835),h,p,e[t+15],16,530742520),f,h,e[t+2],23,-995338651),g=l(g,f=l(f,h=l(h,p,g,f,e[t],6,-198630844),p,g,e[t+7],10,1126891415),h,p,e[t+14],15,-1416354905),f,h,e[t+5],21,-57434055),g=l(g,f=l(f,h=l(h,p,g,f,e[t+12],6,1700485571),p,g,e[t+3],10,-1894986606),h,p,e[t+10],15,-1051523),f,h,e[t+1],21,-2054922799),g=l(g,f=l(f,h=l(h,p,g,f,e[t+8],6,1873313359),p,g,e[t+15],10,-30611744),h,p,e[t+6],15,-1560198380),f,h,e[t+13],21,1309151649),g=l(g,f=l(f,h=l(h,p,g,f,e[t+4],6,-145523070),p,g,e[t+11],10,-1120210379),h,p,e[t+2],15,718787259),f,h,e[t+9],21,-343485551),h=r(h,o),p=r(p,c),g=r(g,u),f=r(f,d);return[h,p,g,f]}function d(e){var n,t="",o=32*e.length;for(n=0;n<o;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function h(e){var n,t=[];for(t[(e.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;var o=8*e.length;for(n=0;n<o;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function p(e){var n,t,o="";for(t=0;t<e.length;t+=1)n=e.charCodeAt(t),o+="0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n);return o}function g(e){return unescape(encodeURIComponent(e))}function f(e){return function(e){return d(u(h(e),8*e.length))}(g(e))}function m(e,n){return function(e,n){var t,o,r=h(e),c=[],a=[];for(c[15]=a[15]=void 0,r.length>16&&(r=u(r,8*e.length)),t=0;t<16;t+=1)c[t]=909522486^r[t],a[t]=1549556828^r[t];return o=u(c.concat(h(n)),512+8*n.length),d(u(a.concat(o),640))}(g(e),g(n))}function _(e,n,t){return n?t?m(n,e):function(e,n){return p(m(e,n))}(n,e):t?f(e):function(e){return p(f(e))}(e)}"function"==typeof define&&define.amd?define(function(){return _}):"object"===(void 0===n?"undefined":o(n))&&n.exports?n.exports=_:$.md5=_,n.exports=_,cc._RF.pop()},{}],Map:[function(e,n,t){"use strict";cc._RF.push(n,"ed1adpX9mZBGLtWUTMIC5PC","Map");var o=Map,r=e("UnitTools");function c(){this.objects=new o}c.prototype.getOrCreate=function(e){if(e=e.toString(),!r.isNullOrUndefined(e)){var n=this.objects.get(e);return r.isNullOrUndefined(n)&&(n={},this.objects.set(e,n)),n}},c.prototype.getNotCreate=function(e){if(e=e.toString(),!r.isNullOrUndefined(e))return this.objects.get(e)},c.prototype.setKeyValue=function(e,n){e=e.toString(),this.objects.set(e,n)},c.prototype.hasKey=function(e){return!r.isNullOrUndefined(e)&&(e=e.toString(),this.objects.has(e))},c.prototype.remove=function(e){r.isNullOrUndefined(e)||(e=e.toString(),this.objects.delete(e))},c.prototype.forEach=function(e){this.objects.forEach(function(n,t){r.isNullOrUndefined(e)||e(t.toString(),n)})},c.prototype.getKeys=function(){var e=[];return this.forEach(function(n,t){e.push(n)}),e},c.prototype.getValues=function(){var e=[];return this.forEach(function(n,t){e.push(t)}),e},c.prototype.count=function(){return this.objects.size},c.prototype.log=function(){this.objects.forEach(function(e,n){console.log("key "+n),console.log("value"),console.log(e)})},n.exports=c,cc._RF.pop()},{UnitTools:"UnitTools"}],Match:[function(e,n,t){"use strict";cc._RF.push(n,"a4d54EIFTVCqJvP1yXfOle4","Match");var o=e("CreatorHelper"),r=e("Constants"),c=r.STAND,a=e("Common"),i=r.RESOURCES,s=e("UnitTools"),l=r.CLOUD_URL,u=r.GAME_TYPE,d={_match:null,_detailLabel:null,_meHead:null,_myName:null,_myScore:null,_opponentHead:null,_opponentsName:null,_opponentsScore:null,_cancelButton:null,_countDown1:null,_countDown2:null,_countDown3:null,_createTime:null,_timeInterval:null,_animSpeed:.3,startMatch:function(){var e=this;void 0!=d._match&&(d._match=null),cc.loader.loadRes("prefabs/Match",cc.Prefab,function(n,t){if(n)cc.error(n);else{var r=cc.instantiate(t);d._match=r;var c=cc.callFunc(e.onFadeOutFinish,e),a=cc.callFunc(e.onFadeInFinish,e);e.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(d._animSpeed,255),cc.scaleTo(d._animSpeed,1)),a),e.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(d._animSpeed,0),cc.scaleTo(d._animSpeed,2)),c),d._detailLabel=cc.find("matchBackground/detailLabel",r).getComponent(cc.Label),d._cancelButton=cc.find("matchBackground/cancelButton",r),d._meHead=cc.find("matchBackground/myBg/me/meMask/meHead",r).getComponent(cc.Sprite),d._opponentHead=cc.find("matchBackground/opponentsBg/opponent/opponentMask/opponentHead",r).getComponent(cc.Sprite),d._myName=cc.find("matchBackground/myBg/myName",r),d._myScore=cc.find("matchBackground/myBg/myScore",r),d._opponentsName=cc.find("matchBackground/opponentsBg/opponentsName",r),d._opponentsScore=cc.find("matchBackground/opponentsBg/opponentsScore",r),d._countDown1=cc.find("matchBackground/countDown1",r),d._countDown2=cc.find("matchBackground/countDown2",r),d._countDown3=cc.find("matchBackground/countDown3",r),d._countDown1.runAction(cc.hide()),d._countDown2.runAction(cc.hide()),d._countDown3.runAction(cc.hide()),d._createTime=(new Date).getTime(),d._timeInterval=window.setInterval(function(){var e=parseInt(((new Date).getTime()-d._createTime)/1e3);d._detailLabel.string="\u6b63\u5728\u5339\u914d\u5bf9\u624b\uff0c\u7528\u65f6"+e+"\u79d2"},1e3),console.log("replace my head ......"),o.changeSpriteFrameWithServerUrl(d._meHead,G.me.avatarUrl+"?aaa=aa.jpg"),d._myName.getComponent(cc.Label).string=G.me.nickName,d._myScore.getComponent(cc.Label).string=G.me.score,console.log("add touch event ......"),d._cancelButton.on("click",e.onCancelClicked,e),d._match.parent=cc.find("Canvas"),console.log("match fade in ......"),e.startFadeIn(),console.log("match config ......"),e.configMatch()}}),e.configMatch=function(){},e.startFadeIn=function(){cc.eventManager.pauseTarget(d._match,!0),d._match.position=cc.p(0,0),d._match.setScale(2),d._match.opacity=0,d._match.runAction(e.actionFadeIn)},e.startFadeOut=function(){cc.eventManager.pauseTarget(d._match,!0),d._match.runAction(e.actionFadeOut)},e.onFadeInFinish=function(){cc.eventManager.resumeTarget(d._match,!0)},e.onFadeOutFinish=function(){e.onDestory()},e.onCancelClicked=function(){e.playClickAudio(),G.index.emit("CancelMatch",{})},e.onDestory=function(){d._match.destroy(),d._match=null,d._meHead=null,d._detailLabel=null,d._cancelButton=null,d._opponentHead=null,d._animSpeed=.3,d._myName=null,d._myScore=null,d._opponentsName=null,d._opponentsScore=null,d._countDown1=null,d._countDown2=null,d._countDown3=null,d._createTime=null,s.isNullOrUndefined(d._timeInterval)||(window.clearInterval(d._timeInterval),d._timeInterval=null)},e.playClickAudio=function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(i.click,cc.AudioClip))},console.log(G.index),G.index.on("MatchSuccess",function(e){console.log("\u5339\u914d\u6210\u529f\uff1a",e),s.isNullOrUndefined(d._timeInterval)||window.clearInterval(d._timeInterval),d._detailLabel.string="\u5339\u914d\u6210\u529f",d._cancelButton.active=!1,console.log("match success, roomId = "+e.roomId),G.index.request({url:l+"/opponent",success:function(e){if(console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code)a.showSysError();else{var n=e.data.data;s.isNullOrUndefined(n)?a.showSysError():(G.opponent=n,o.changeSpriteFrameWithServerUrl(d._opponentHead,G.opponent.avatarUrl+"?aaa=aa.jpg"),d._opponentsName.getComponent(cc.Label).string=G.opponent.nickName,d._opponentsScore.getComponent(cc.Label).string=G.opponent.score)}},fail:function(){a.showSysError()}}),d._countDown3.runAction(cc.sequence(cc.show(),cc.scaleTo(.5,1,2),cc.delayTime(.5),cc.hide())),d._countDown2.runAction(cc.delayTime(1),cc.sequence(cc.show(),cc.scaleTo(.5,1,2),cc.delayTime(.5),cc.hide())),d._countDown1.runAction(cc.delayTime(2),cc.sequence(cc.show(),cc.scaleTo(.5,1,2),cc.callFunc(function(){G.index.emit("StartGame",{})})))}),G.index.on("GameStart",function(n){s.isNullOrUndefined(G.opponent)?G.index.request({url:l+"/opponent",success:function(t){if(console.log(t),s.isNullOrUndefined(t.data)||0!=t.data.code)a.showSysError();else{var o=t.data.data;s.isNullOrUndefined(o)?a.showSysError():(G.opponent=o,console.log("\u6e38\u620f\u5f00\u59cb\uff1a",n),G.gameType=u.MATCH,0===n.pos?G.stand=c.BLACK:1===n.pos&&(G.stand=c.WHITE),G.roomId=n.roomId,e.startFadeOut(),cc.director.loadScene("game"))}},fail:function(){a.showSysError()}}):(console.log("\u6e38\u620f\u5f00\u59cb\uff1a",n),G.gameType=u.MATCH,0===n.pos?G.stand=c.BLACK:1===n.pos&&(G.stand=c.WHITE),G.roomId=n.roomId,e.startFadeOut(),cc.director.loadScene("game"))}),G.index.on("CancelMatchSuccess",function(){console.log("\u53d6\u6d88\u5339\u914d\u6210\u529f"),s.isNullOrUndefined(d._timeInterval)||window.clearInterval(d._timeInterval),e.startFadeOut()}),G.index.on("CancelMatchError",function(e){console.error("\u53d6\u6d88\u5339\u914d\u5931\u8d25\uff1a",e.error),s.isNullOrUndefined(d._timeInterval)||window.clearInterval(d._timeInterval)}),G.index.on("MatchTimeout",function(){s.isNullOrUndefined(d._timeInterval)||window.clearInterval(d._timeInterval),d._detailLabel.string="\u5339\u914d\u8d85\u65f6\uff0c\u8bf7\u53d6\u6d88\u5e76\u91cd\u65b0\u5339\u914d"})}};n.exports={startMatch:d.startMatch};cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],MenuManager:[function(e,n,t){"use strict";cc._RF.push(n,"dbed4TWiO9G8rOPLhxoyUSx","MenuManager");var o=e("Constants"),r=o.CLOUD_URL,c=e("index"),a=e("Alert"),i=e("CreatorHelper"),s=e("Match"),l=e("Room"),u=o.GAME_TYPE,d=o.STAND,h=o.SERVER_PLAYER_STATE,p=e("UnitTools"),g=o.SCENE,f=e("ShowInfo"),m=o.INFO_TYPE,_=e("Common"),S=o.RESOURCES,C=e("Notice");cc.Class({extends:cc.Component,properties:{head:cc.Sprite,playerName:cc.Label,friendBtn:cc.Sprite,robotBtn:cc.Sprite,rankingBtn:cc.Sprite,info:cc.Label,leftCurtain:cc.Node,leftCurtainSprite:cc.Sprite,rightCurtain:cc.Node,rightCurtainSprite:cc.Sprite,bg:cc.Sprite,coin:cc.Label,diamond:cc.Label,authorizeBtn:cc.Node},playClickAudio:function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(S.click,cc.AudioClip))},createAuthorizeBtn:function(){var e=this.authorizeBtn,n=cc.size(e.width+10,e.height+10),t=cc.view.getFrameSize(),o=cc.director.getWinSize();console.log("winSize: ",o),console.log("frameSize: ",t);var r=(.5*o.width+e.x-.5*n.width)/o.width*t.width,c=(.5*o.height-e.y-.5*n.height)/o.height*t.height,a=n.width/o.width*t.width,i=n.height/o.height*t.height;console.log("button pos: ",cc.v2(r,c)),console.log("button size: ",cc.size(a,i));var s=this;s.btnAuthorize=wx.createUserInfoButton({type:"text",text:"",style:{left:r,top:c,width:a,height:i,lineHeight:0,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}),s.btnAuthorize.onTap(function(e){console.log("onTap uinfo: ",e),e.userInfo?(s.btnAuthorize.hide(),s.btnAuthorize.destroy(),s.authorizeBtn.active=!1,s.login()):console.log("wxLogin auth fail")})},onLoad:function(){G.currentScene=g.MENU;var e=this;e.leftCurtainSprite.spriteFrame=new cc.SpriteFrame(cc.loader.getRes(S.curtain,cc.SpriteFrame)),e.rightCurtainSprite.spriteFrame=new cc.SpriteFrame(cc.loader.getRes(S.curtain,cc.SpriteFrame)),e.leftCurtain.active=!1,e.rightCurtain.active=!1,console.log("G.index =>",G.index),p.isNullOrUndefined(G.index)&&(console.log("config G.Index..."),G.index=c,G.index.setLoginUrl(r+"/login"),G.index.Tunnel(r+"/tunnel"),console.log("G.index.tunnel =>",G.index.Tunnel)),c.Session.get()?(console.log("session, already login in"),e.authorizeBtn.active=!1,wx.showLoading({title:"\u52a0\u8f7d\u4e2d...",mask:!0}),c.loginWithCode({success:function(n){e.writePlayerInfo(),wx.hideLoading(),G.hasLogin=!0,e.configTunnel();var t=wx.getLaunchOptionsSync();if(console.log("LaunchOption => ",t),p.isNullOrUndefined(t)||p.isNullOrUndefined(t.query)||p.isNullOrUndefined(t.query.roomId)||(G.queryRoomId=t.query.roomId),!p.isNullOrUndefined(G.queryRoomId)){var o=G.queryRoomId;G.queryRoomId=null,console.log("System Start JoinGame"),G.index.emit("JoinGame",{roomId:o})}},fail:function(e){console.error(e),wx.hideLoading()}})):(console.log("no session, create authorize btn"),e.createAuthorizeBtn(),G.music&&cc.audioEngine.playMusic(cc.loader.getRes(S.bgm,cc.AudioClip),!0,1)),G.menuManager=e},changeScene:function(e,n){this.leftCurtain.active=!0,this.rightCurtain.active=!0,console.log(this.leftCurtain);var t=cc.moveTo(e,cc.p(0,0)),o=cc.moveTo(e,cc.p(0,0));this.leftCurtain.runAction(t),this.rightCurtain.runAction(cc.sequence(o,cc.callFunc(function(){cc.director.loadScene(n)})))},start:function(){},test:function(){},update:function(){},groupFriendButtonFunc:function(){wx.shareAppMessage({success:function(e){void 0!=e.shareTickets&&e.shareTickets.length>0&&wx.getOpenDataContext().postMessage({messageType:5,MAIN_MENU_NUM:G.gameId,shareTicket:e.shareTickets[0]})}})},login:function(){var e=this;wx.showLoading({title:"\u52a0\u8f7d\u4e2d...",mask:!0}),G.index.login({success:function(){G.hasLogin=!0,e.test(),e.configTunnel();var n=wx.getLaunchOptionsSync();if(console.log("LaunchOption => ",n),p.isNullOrUndefined(n)||p.isNullOrUndefined(n.query)||p.isNullOrUndefined(n.query.roomId)||(G.queryRoomId=n.query.roomId),!p.isNullOrUndefined(G.queryRoomId)){var t=G.queryRoomId;G.queryRoomId=null,console.log("System Start JoinGame"),G.index.emit("JoinGame",{roomId:t})}wx.hideLoading()},fail:function(n){wx.hideLoading(),console.log("\u767b\u5f55\u5931\u8d25",n),setTimeout(function(){e.login()},1e3)}})},configTunnel:function(){var e=this;G.index.isClosed()?(G.index.on("connect",function(){wx.hideLoading(),console.log("WebSocket \u4fe1\u9053\u5df2\u8fde\u63a5"),e.refreshPlayerInfo()}),G.index.on("close",function(){wx.showLoading({title:"\u5df2\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5...",mask:!0}),console.log("WebSocket \u4fe1\u9053\u5df2\u65ad\u5f00")}),G.index.on("reconnecting",function(){wx.hideLoading(),wx.showLoading({title:"\u6b63\u5728\u4e0e\u670d\u52a1\u5668\u91cd\u8fde...",mask:!0}),console.log("WebSocket \u4fe1\u9053\u6b63\u5728\u91cd\u8fde...")}),G.index.on("reconnect",function(){wx.hideLoading(),console.log("WebSocket \u4fe1\u9053\u91cd\u8fde\u6210\u529f"),e.refreshPlayerInfo()}),G.index.on("error",function(e){console.error("\u4fe1\u9053\u53d1\u751f\u9519\u8bef\uff1a",e)}),G.index.on("MatchStart",function(){return s.startMatch()}),G.index.on("MatchError",function(){return a.show("\u5339\u914d\u5931\u8d25 \u8bf7\u518d\u8bd5\u4e00\u6b21",null,!1)}),G.index.on("RoomCreated",function(e){console.log("RoomCreated, roomId = "+e.roomId),G.queryRoomId=null,G.index.request({url:r+"/room",success:function(n){if(console.log(n),p.isNullOrUndefined(n.data)||0!=n.data.code)1==n.data.code?_.showClearError():_.showSysError();else{var t=n.data.data;p.isNullOrUndefined(t)||p.isNullOrUndefined(t.me)||p.isNullOrUndefined(t.roomId)||(G.stand=e.stand,G.opponent=t.opponent,l.createRoom(t))}},fail:function(e){console.log(e)}})}),G.index.on("RoomError",function(){G.queryRoomId=null,a.show("\u521b\u5efa\u623f\u95f4\u5931\u8d25 \u8bf7\u518d\u8bd5\u4e00\u6b21",null,!1)}),G.index.on("reconnecting",function(){console.log("WebSocket \u4fe1\u9053\u6b63\u5728\u91cd\u8fde...")}),G.index.on("GamePreparing",function(){console.log("GamePreparing."),cc.director.loadScene("menu")}),G.index.on("GameHasEnded",function(){console.log("GameHasEnded."),cc.director.loadScene("menu")}),G.index.on("JoinRoomSuccess",function(e){console.log("JoinRoomSuccess. roomId = "+e.roomId),G.queryRoomId=null,G.index.request({url:r+"/room",success:function(n){if(console.log(n),p.isNullOrUndefined(n.data)||0!=n.data.code)1==n.data.code?_.showClearError():_.showSysError();else{var t=n.data.data;p.isNullOrUndefined(t)||p.isNullOrUndefined(t.me)||p.isNullOrUndefined(t.roomId)||(G.stand=e.stand,G.opponent=t.opponent,l.createRoom(t))}},fail:function(e){console.log(e)}})}),G.index.on("JoinRoomError",function(){G.queryRoomId=null}),G.index.open(),console.log("Tunnel is open")):(console.log("login, G.index.isActive() => "+G.index.isActive()),console.log("login, G.index.isClosed() => "+G.index.isClosed()),console.log("login, G.index.isConnecting() => "+G.index.isConnecting()),console.log("login, G.index.isReconnecting() => "+G.index.isReconnecting()))},writePlayerInfo:function(){this.refreshPlayerInfo()},refreshPlayerInfo:function(){var e=this;G.index.request({url:r+"/player",success:function(n){if(console.log(n),p.isNullOrUndefined(n.data)||0!=n.data.code)_.showSysError();else{var t=n.data.data;if(console.log("player =>",t),p.isNullOrUndefined(t))_.showSysError();else if(G.me=t,G.playerCache=!0,p.isNullOrUndefined(G.currentScene)||G.currentScene!==g.MENU||(console.log("menu =>",e),p.isNullOrUndefined(e.playerName)||(e.playerName.string=t.nickName),i.changeSpriteFrameWithServerUrl(e.head,t.avatarUrl+"?aaa=aa.jpg"),G.menuManager.coin.string=t.coin),p.isNullOrUndefined(t.score)||(wx.postMessage({messageType:3,MAIN_MENU_NUM:G.gameId,score:t.score}),p.isNullOrUndefined(G.currentScene)||G.currentScene!==g.MENU||(G.menuManager.info.string=t.score)),!p.isNullOrUndefined(t.state))if(t.state===h.MATCHING)p.isNullOrUndefined(G.currentScene)||G.currentScene===g.MENU||cc.director.loadScene("menu"),s.startMatch();else if(t.state===h.IN_GAME)G.index.request({url:r+"/opponent",success:function(e){if(console.log(e),p.isNullOrUndefined(e.data)||0!=e.data.code)_.showSysError();else{var n=e.data.data;p.isNullOrUndefined(n)?_.showSysError():(G.opponent=n,G.newGame=!1,cc.director.loadScene("game"))}},fail:function(){_.showSysError()}});else if(t.state===h.MATCH_SUCCESS)G.index.on("GameStart",function(n){G.index.request({url:r+"/opponent",success:function(t){if(console.log(t),p.isNullOrUndefined(t.data)||0!=t.data.code)_.showSysError();else{var o=t.data.data;p.isNullOrUndefined(o)?_.showSysError():(G.opponent=o,console.log("\u6e38\u620f\u5f00\u59cb\uff1a",n),G.gameType=u.MATCH,0===n.pos?G.stand=d.BLACK:1===n.pos&&(G.stand=d.WHITE),G.roomId=n.roomId,e.startFadeOut(),cc.director.loadScene("game"))}},fail:function(){_.showSysError()}})}),G.index.emit("StartGame",{});else if(t.state===h.GAME_PREPARE)G.index.request({url:r+"/room",success:function(e){if(console.log(e),p.isNullOrUndefined(e.data)||0!=e.data.code)1==e.data.code?_.showClearError():_.showSysError();else{var n=e.data.data;p.isNullOrUndefined(n)||p.isNullOrUndefined(n.me)||p.isNullOrUndefined(n.roomId)||(G.stand=e.stand,G.opponent=n.opponent,l.createRoom(n))}},fail:function(e){console.log(e)}});else if(t.state===h.SETTLEMENT)f.show(m.SETTLEMENT,function(e){e===h.IN_HALL&&G.currentScene!==g.MENU&&cc.director.loadScene("menu")});else if(t.state===h.IN_HALL&&!p.isNullOrUndefined(G.currentScene))if(G.currentScene!==g.MENU)G.gameType&&G.gameType!==u.ROBOT&&cc.director.loadScene("menu");else if(!p.isNullOrUndefined(G.queryRoomId)){var o=G.queryRoomId;G.queryRoomId=null,console.log("System Start JoinGame"),G.index.emit("JoinGame",{roomId:o})}}},fail:function(){_.showSysError()}})},onRankingStart:function(){this.playClickAudio(),G.index.request({url:r+"/room",success:function(e){console.log(e),p.isNullOrUndefined(e.data)||-3!=e.data.code&&-4!=e.data.code?p.isNullOrUndefined(e.data)||0!=e.data.code&&1!=e.data.code?_.showSysError():_.showClearError():(G.gameType=u.RANK,console.log("Match"),G.index.emit("Match",{}))},fail:function(){_.showSysError()}})},onRobotStart:function(){this.playClickAudio(),G.stand=d.BLACK,G.gameType=u.ROBOT,this.changeScene(1,"game")},onFriendStart:function(){this.playClickAudio(),console.log("Friend"),G.index.emit("Friend",{})},onRankingShow:function(){this.playClickAudio(),cc.director.loadScene("rank")},onNoticeShow:function(){this.playClickAudio(),C.show()},onShopShow:function(){this.playClickAudio(),cc.director.loadScene("shop")},onSoundTrigger:function(){G.music=!G.music,console.log("music == "+G.music),G.music?(cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects()):(cc.audioEngine.pauseMusic(),cc.audioEngine.pauseAllEffects())},onShareShow:function(){wx.shareAppMessage({title:"\u79f0\u96c4\u57ce\u5821\uff0c\u4f60\u51ed\u4ec0\u4e48\u8ddf\u6211\u6253\uff1f",imageUrl:S.share_1,success:function(e){console.log("\u8f6c\u53d1\u6210\u529f!!!"),null==e.shareTickets||void 0==e.shareTickets||""==e.shareTickets?console.log("res.shareTickets is null"):(console.log("res.shareTickets is not null"),e.shareTickets.length>0&&console.log("\u53ef\u6267\u884c\u7fa4\u5206\u4eab\u6210\u529f\u64cd\u4f5c"))},fail:function(e){console.log("\u8f6c\u53d1\u5931\u8d25!!!")}})}}),cc._RF.pop()},{Alert:"Alert",Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",Match:"Match",Notice:"Notice",Room:"Room",ShowInfo:"ShowInfo",UnitTools:"UnitTools",index:"index"}],Notice:[function(e,n,t){"use strict";cc._RF.push(n,"52625NOSyRL+J0NnLlSFRMc","Notice");var o=e("Constants"),r=o.RESOURCES,c=e("UnitTools"),a=o.CLOUD_URL,i={_notice:null,_detailLabel:null,_quitButton:null,_animSpeed:.3,show:function(e,n,t,o){var s=this;void 0!=i._notice&&(i._notice=null),i._animSpeed=o||i._animSpeed,cc.loader.loadRes("prefabs/Notice",cc.Prefab,function(e,n){if(e)cc.error(e);else{var t=cc.instantiate(n);i._notice=t;var o=cc.callFunc(s.onFadeOutFinish,s),r=cc.callFunc(s.onFadeInFinish,s);s.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(i._animSpeed,255),cc.scaleTo(i._animSpeed,1)),r),s.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(i._animSpeed,0),cc.scaleTo(i._animSpeed,2)),o),i._detailLabel=cc.find("noticeBackground/noticeBg2/scrollView/viewport/content/detailLabel",t).getComponent(cc.Label),i._quitButton=cc.find("noticeBackground/quitButton",t),i._quitButton.on("click",s.onButtonClicked,s),i._notice.parent=cc.find("Canvas"),s.loadNotice(),s.startFadeIn()}}),s.startFadeIn=function(){cc.eventManager.pauseTarget(i._notice,!0),i._notice.position=cc.p(0,0),i._notice.setScale(2),i._notice.opacity=0,i._notice.runAction(s.actionFadeIn)},s.startFadeOut=function(){cc.eventManager.pauseTarget(i._notice,!0),i._notice.runAction(s.actionFadeOut)},s.onFadeInFinish=function(){cc.eventManager.resumeTarget(i._notice,!0)},s.onFadeOutFinish=function(){s.onDestory()},s.onButtonClicked=function(e){s.playClickAudio(),s.startFadeOut()},s.onDestory=function(){i._notice.destroy(),i._notice=null,i._detailLabel=null,i._quitButton=null,i._animSpeed=.3},s.playClickAudio=function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))},s.loadNotice=function(){G.index.request({url:a+"/notice",success:function(e){console.log("notice => ",e),c.isNullOrUndefined(e.data)||0!=e.data.code||c.isNullOrUndefined(e.data.data)||(i._detailLabel.string=e.data.data)},fail:function(){}})}}};n.exports={show:i.show};cc._RF.pop()},{Constants:"Constants",UnitTools:"UnitTools"}],PreChessManager:[function(e,n,t){"use strict";cc._RF.push(n,"e6f71OWfblCt4JqLdM6cvs5","PreChessManager");var o=e("Constants"),r=o.CHESS_TYPE,c=o.GAME_STATE;cc.Class({extends:cc.Component,properties:{COL:8,ROW:8,chessPrefab:cc.Prefab,preChesses:[],events:null},onLoad:function(){G.preChessManager=this,this.chessWidth=this.node.width/this.COL,this.count=0;for(var e=0;e<this.COL;e++){this.preChesses[e]=[];for(var n=0;n<this.ROW;n++){var t=cc.instantiate(this.chessPrefab);t.parent=this.node,t.width=this.chessWidth-5,t.height=this.chessWidth-5,t.position=cc.p(this.chessWidth/2+e*this.chessWidth,this.chessWidth/2+n*this.chessWidth);var o=t.getComponent("PreChess");o.coor=cc.p(e,n),this.preChesses[e][n]=o}}},showJudgeMoveAble:function(e){if(G.stand===e){this.count++;for(var n=this.count,t=null,o=0;o<this.COL;o++)for(var a=0;a<this.ROW;a++)if((t=G.chessManager.chesses[o][a]).type===r.NONE)for(var i=1;i<=8;i++)G.chessManager.judgePass(e,t,i)&&G.gameManager.gameState===c.PLAYING&&n===this.count&&G.stand===e&&(this.preChesses[o][a].type=e)}},hideJudgeMoveAble:function(){for(var e=null,n=0;n<this.COL;n++)for(var t=0;t<this.ROW;t++)(e=this.preChesses[n][t]).type!==r.BLACK&&e.type!==r.WHITE||(this.preChesses[n][t].type=r.NONE)}}),cc._RF.pop()},{Constants:"Constants"}],PreChess:[function(e,n,t){"use strict";cc._RF.push(n,"390e2o93RJNjIcRpsyoUS8p","PreChess");var o=e("Constants"),r=o.CHESS_TYPE,c=o.RESOURCES;cc.Class({extends:cc.Component,properties:{pics:{default:[],type:[cc.SpriteFrame]},black:cc.SpriteFrame,white:cc.SpriteFrame,_type:r.NONE,type:{get:function(){return this._type},set:function(e){this._type=e,e===r.BLACK?this.getComponent(cc.Sprite).spriteFrame=this.black:e===r.WHITE?this.getComponent(cc.Sprite).spriteFrame=this.white:this.getComponent(cc.Sprite).spriteFrame=null}},coor:cc.p(0,0)},onLoad:function(){this.black=new cc.SpriteFrame(cc.loader.getRes(c.kuang_1,cc.SpriteFrame)),this.white=new cc.SpriteFrame(cc.loader.getRes(c.kuang_2,cc.SpriteFrame)),this.type=r.NONE}}),cc._RF.pop()},{Constants:"Constants"}],RankManager:[function(e,n,t){"use strict";cc._RF.push(n,"6524b8758FHu74waRleIxy0","RankManager");var o=e("Constants"),r=o.RESOURCES,c=e("CreatorHelper"),a=e("UnitTools"),i=e("Common"),s=o.CLOUD_URL;cc.Class({extends:cc.Component,properties:{friendTab:cc.Node,weekTab:cc.Node,totalTab:cc.Node,friendTabFont:cc.Node,weekTabFont:cc.Node,totalTabFont:cc.Node},onLoad:function(){},start:function(){this.friendButtonFunc()},update:function(){},onFriendTabClicked:function(){c.changeSpriteFrame(this.friendTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow1_phb"),c.changeSpriteFrame(this.weekTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.totalTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.friendTabFont.getComponent(cc.Sprite),"textures/Rank/txt_hyb"),c.changeSpriteFrame(this.weekTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zphh_h"),c.changeSpriteFrame(this.totalTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zph_h"),this.friendButtonFunc()},onWeekTabClicked:function(){c.changeSpriteFrame(this.friendTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.weekTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow1_phb"),c.changeSpriteFrame(this.totalTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.friendTabFont.getComponent(cc.Sprite),"textures/Rank/txt_hyb_h"),c.changeSpriteFrame(this.weekTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zphh"),c.changeSpriteFrame(this.totalTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zph_h"),this.weeklyClickFunc()},onTotalTabClicked:function(){c.changeSpriteFrame(this.friendTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.weekTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow2_phb"),c.changeSpriteFrame(this.totalTab.getComponent(cc.Sprite),"textures/Rank/btn_yllow1_phb"),c.changeSpriteFrame(this.friendTabFont.getComponent(cc.Sprite),"textures/Rank/txt_hyb_h"),c.changeSpriteFrame(this.weekTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zphh_h"),c.changeSpriteFrame(this.totalTabFont.getComponent(cc.Sprite),"textures/Rank/txt_zph"),this.monthlyClickFunc()},playClickAudio:function(){cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))},friendButtonFunc:function(){wx.postMessage({messageType:7,MAIN_MENU_NUM:G.gameId})},weeklyClickFunc:function(){G.index.request({url:s+"/weeklyRank",success:function(e){console.log(e),a.isNullOrUndefined(e.data)||0!=e.data.code?i.showSysError():wx.postMessage({messageType:9,data:JSON.stringify(e.data.data)})},fail:function(){i.showSysError()}})},monthlyClickFunc:function(){G.index.request({url:s+"/MonthlyRank",success:function(e){console.log(e),a.isNullOrUndefined(e.data)||0!=e.data.code?i.showSysError():wx.postMessage({messageType:11,data:JSON.stringify(e.data.data)})},fail:function(){i.showSysError()}})},quit:function(){cc.director.loadScene("menu")}}),cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],Rank:[function(e,n,t){"use strict";cc._RF.push(n,"a872aTptqBFvYdT8JTVgCjh","Rank");var o=e("Constants"),r=o.RESOURCES,c=(o.CLOUD_URL,e("UnitTools"),e("CreatorHelper")),a={_rank:null,_animSpeed:.3,_closeBtn:null,_friendTab:null,_weekTab:null,_totalTab:null,_friendTabLabel:null,_weekTabLabel:null,_totalTabLabel:null,_rankingScrollView:null,_tex:null,show:function(){var e=this;void 0!=a._rank&&(a._rank=null),cc.loader.loadRes("prefabs/Rank",cc.Prefab,function(n,t){if(n)cc.error(n);else{var o=cc.instantiate(t);a._rank=o;var r=cc.callFunc(e.onFadeOutFinish,e),c=cc.callFunc(e.onFadeInFinish,e);e.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(a._animSpeed,255),cc.scaleTo(a._animSpeed,1)),c),e.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(a._animSpeed,0),cc.scaleTo(a._animSpeed,2)),r),a._friendTab=cc.find("rankBackground/friendTab",o),a._weekTab=cc.find("rankBackground/weekTab",o),a._totalTab=cc.find("rankBackground/totalTab",o),a._closeBtn=cc.find("rankBackground/quit",o),a._friendTabLabel=cc.find("rankBackground/friendTab/friendTabLabel",o),a._weekTabLabel=cc.find("rankBackground/weekTab/weekTabLabel",o),a._totalTabLabel=cc.find("rankBackground/totalTab/totalTabLabel",o),a._rankingScrollView=cc.find("rankBackground/rankingScrollView",o).getComponent(cc.Sprite),a._friendTab.on("click",e.onFriendTabClicked,e),a._weekTab.on("click",e.onWeekTabClicked,e),a._totalTab.on("click",e.onTotalTabClicked,e),a._closeBtn.on("click",e.startFadeOut,e),a._rank.parent=cc.find("Canvas"),a._tex=new cc.Texture2D,window.sharedCanvas.width=110,window.sharedCanvas.height=500,window.wx.postMessage({messageType:1,MAIN_MENU_NUM:G.gameId}),setTimeout(function(){e._updateSubDomainCanvas()},500),e.startFadeIn()}}),e._updateSubDomainCanvas=function(){void 0!=window.sharedCanvas&&(a._tex.initWithElement(window.sharedCanvas),a._tex.handleLoadedTexture(),a._rankingScrollView.spriteFrame=new cc.SpriteFrame(a._tex))},e.startFadeIn=function(){cc.eventManager.pauseTarget(a._rank,!0),a._rank.position=cc.p(0,0),a._rank.setScale(2),a._rank.opacity=0,a._rank.runAction(e.actionFadeIn)},e.onFriendTabClicked=function(){c.changeSpriteFrame(a._friendTab.getComponent(cc.Sprite),"textures/Shop/6"),c.changeSpriteFrame(a._weekTab.getComponent(cc.Sprite),"textures/Shop/5"),c.changeSpriteFrame(a._totalTab.getComponent(cc.Sprite),"textures/Shop/5"),a._friendTabLabel.setColor(cc.Color.BLACK),a._weekTabLabel.setColor(cc.Color.WHITE),a._totalTabLabel.setColor(cc.Color.WHITE)},e.onWeekTabClicked=function(){c.changeSpriteFrame(a._friendTab.getComponent(cc.Sprite),"textures/Shop/5"),c.changeSpriteFrame(a._weekTab.getComponent(cc.Sprite),"textures/Shop/6"),c.changeSpriteFrame(a._totalTab.getComponent(cc.Sprite),"textures/Shop/5"),a._friendTabLabel.setColor(cc.Color.WHITE),a._weekTabLabel.setColor(cc.Color.BLACK),a._totalTabLabel.setColor(cc.Color.WHITE)},e.onTotalTabClicked=function(){c.changeSpriteFrame(a._friendTab.getComponent(cc.Sprite),"textures/Shop/5"),c.changeSpriteFrame(a._weekTab.getComponent(cc.Sprite),"textures/Shop/5"),c.changeSpriteFrame(a._totalTab.getComponent(cc.Sprite),"textures/Shop/6"),a._friendTabLabel.setColor(cc.Color.WHITE),a._weekTabLabel.setColor(cc.Color.WHITE),a._totalTabLabel.setColor(cc.Color.BLACK)},e.startFadeOut=function(){cc.eventManager.pauseTarget(a._rank,!0),a._rank.runAction(e.actionFadeOut)},e.onFadeInFinish=function(){cc.eventManager.resumeTarget(a._rank,!0)},e.onFadeOutFinish=function(){e.onDestory()},e.onDestory=function(){a._rank.destroy(),a._rank=null,a._animSpeed=.3,a._friendTab=null,a._weekTab=null,a._totalTab=null,a._friendTabLabel=null,a._weekTabLabel=null,a._totalTabLabel=null},e.playClickAudio=function(){cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))}}};n.exports={show:a.show};cc._RF.pop()},{Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],Robot:[function(e,n,t){"use strict";cc._RF.push(n,"569b2uASQNHGamXwX7E/1tp","Robot");var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var r=[[90,-60,10,10,10,10,-60,90],[-60,-80,5,5,5,5,-80,-60],[10,5,1,1,1,1,5,10],[10,5,1,1,1,1,5,10],[10,5,1,1,1,1,5,10],[10,5,1,1,1,1,5,10],[-60,-80,5,5,5,5,-80,-60],[90,-60,10,10,10,10,-60,90]],c=[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,-1],[1,1],[-1,1]],a=8,i=function(){function e(n,t){(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")})(this,e),this.x=n,this.y=t}return o(e,[{key:"add",value:function(e,n){this.x+=e,this.y+=n}}]),e}();function s(e,n){for(var t=0;t<a;++t)for(var o=0;o<a;++o)e[t][o]=n[t][o]}function l(e,n,t,o){if(o[e][n])return 0;for(var r=1===t?1:-1,s=0,l=0,u=0;u<a;++u){l=0;for(var d=new i(e+c[u][0],n+c[u][1]);d.x>=0&&d.x<a&&d.y>=0&&d.y<a&&o[d.x][d.y];){if(o[d.x][d.y]!==-r){s+=l;break}l++,d.add(c[u][0],c[u][1])}}return s}function u(e,n){for(var t,o=n[e.x][e.y],r=0;r<a;++r){t=!1;for(var s=new i(e.x+c[r][0],e.y+c[r][1]);s.x>=0&&s.x<a&&s.y>=0&&s.y<a&&n[s.x][s.y];){if(n[s.x][s.y]!==-o){if(t){s.add(-c[r][0],-c[r][1]);for(var l=new i(e.x+c[r][0],e.y+c[r][1]);(e.x<=l.x&&l.x<=s.x||s.x<=l.x&&l.x<=e.x)&&(e.y<=l.y&&l.y<=s.y||s.y<=l.y&&l.y<=e.y);)l.add(c[r][0],c[r][1])}break}t=!0,s.add(c[r][0],c[r][1])}}}function d(e,n,t,o,c,h,p){if(h>=p)return 0;for(var g=-10005,f=[],m=0;m<a;++m)f[m]=[];for(var _=[],S=0;S<a;++S)_[S]=[];for(var C=[],T=0;T<a;++T)C[T]=[];for(var v=[],E=0;E<a;++E)v[E]=[];s(_,o);var b=r[e][n]+c[e][n],y=new i(e,n);u(y,_);for(var w=0,k=0,F=0;F<a;++F)for(var N=0;N<a;++N)if(f[F][N]=l(F,N,-t,_),f[F][N]){if(++k,0===F&&0===N||0===F&&N===a-1||F===a-1&&N===a-1||F===a-1&&0===N)return-1e3;(F<2&&N<2||F<2&&a-N-1<2||a-1-F<2&&N<2||a-1-F<2&&a-1-N<2)&&++w}if(10*w>7*k)return 1400;for(var R=0;R<a;++R)for(var G=0;G<a;++G)if(f[R][G]){var O=r[R][G]+f[R][G];s(C,_),C[R][G]=-t,y.x=R,y.y=G,u(y,C);for(var I=0;I<a;++I)for(var A=0;A<a;++A)v[I][A]=l(I,A,t,C);for(var B=0;B<a;++B)for(var U=0;U<a;++U)if(v[B][U]){var x=b-O+d(B,U,t,C,v,h+1,p);g=g<x?x:g}}return g}n.exports=function(e,n,t){for(var o=[],c=0;c<a;++c)o[c]=[];switch(function(e,n,t){for(var o=0;o<a;++o)for(var r=0;r<a;++r)n[o][r]=l(o,r,t,e),n[o][r]&&0}(e,o,n),t){case 1:return function(e){for(var n=new i(null,null),t=0,o=0;o<a;++o)for(var r=0;r<a;++r)e[o][r]>=t&&(t=e[o][r],n.x=o,n.y=r);return n}(o);case 2:return function(e,n,t){for(var o=0,c=[],d=0;d<a;++d)c[d]=[];for(var h=[],p=0;p<a;++p)h[p]=[];function g(e,n,t){this.x=e,this.y=n,this.w=t}for(var f=[],m=0;m<a;++m)for(var _=0;_<a;++_)if(n[m][_]){o=r[m][_]+n[m][_],s(h,e),h[m][_]=t;var S=new i(m,_);if(0===m&&0===_||0===m&&_===a-1||m===a-1&&0===_||m===a-1&&_===a-1)return S;u(S,h);for(var C=-1050,T=0;T<a;++T)for(var v=0;v<a;++v)c[T][v]=l(T,v,-t,h),c[T][v]&&(C=C<r[T][v]+c[T][v]?r[T][v]+c[T][v]:C);f.push(new g(m,_,o-C))}for(var E in f.sort(function(e,n){return n.w-e.w}),f)if(!(f[E].x<2&&f[E].y<2||f[E].x<2&&a-f[E].y-1<2||a-f[E].x-1<2&&f[E].y<2||a-1-f[E].x<2&&a-1-f[E].y<2))return new i(f[E].x,f[E].y);return f.length>0?new i(f[0].x,f[0].y):new i(null,null)}(e,o,n);case 3:return function(e,n,t){for(var o=new i(null,null),r=-10005,c=0;c<a;++c)for(var s=0;s<a;++s)if(n[c][s]){if(0===c&&0===s||0===c&&s===a-1||c===a-1&&s===a-1||c===a-1&&0===s)return o.x=c,o.y=s,o;var l=d(c,s,t,e,n,0,3);l>=r&&(r=l,o.x=c,o.y=s)}return o}(e,o,n)}},cc._RF.pop()},{}],Room:[function(e,n,t){"use strict";cc._RF.push(n,"fdc7151HspDkqQLbYOPNlgw","Room");var o=e("CreatorHelper"),r=e("Constants"),c=r.CLOUD_URL,a=r.GAME_TYPE,i=r.CONFIRM_BUTTON_FONT,s=e("UnitTools"),l=e("Common"),u=r.RESOURCES,d=r.STAND,h={_room:null,_detailLabel:null,_meHead:null,_myName:null,_opponentHead:null,_opponentsName:null,_opponentsScore:null,_confirmButton:null,_cancelButton:null,_animSpeed:.3,_confirmButtonFont:null,_roomId:null,createRoom:function(e){var n=this;void 0==h._room&&(cc.loader.loadRes("prefabs/Room",cc.Prefab,function(t,r){if(t)cc.error(t);else{var c=cc.instantiate(r);h._room=c;var a=cc.callFunc(n.onFadeOutFinish,n),l=cc.callFunc(n.onFadeInFinish,n);n.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(c._animSpeed,255),cc.scaleTo(c._animSpeed,1)),l),n.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(c._animSpeed,0),cc.scaleTo(c._animSpeed,2)),a),h._detailLabel=cc.find("roomBackground/detailLabel",c).getComponent(cc.Label),h._confirmButton=cc.find("roomBackground/confirmButton",c),h._cancelButton=cc.find("roomBackground/cancelButton",c),h._confirmButtonFont=cc.find("roomBackground/confirmButton/confirmButtonFont",c).getComponent(cc.Sprite),h._meHead=cc.find("roomBackground/myBg/me/meMask/meHead",c).getComponent(cc.Sprite),h._opponentHead=cc.find("roomBackground/opponentsBg/opponent/opponentMask/opponentHead",c).getComponent(cc.Sprite),h._myName=cc.find("roomBackground/myBg/myName",c).getComponent(cc.Label),h._myScore=cc.find("roomBackground/myBg/myScore",c).getComponent(cc.Label),h._opponentsName=cc.find("roomBackground/opponentsBg/opponentsName",c).getComponent(cc.Label),h._opponentsScore=cc.find("roomBackground/opponentsBg/opponentsScore",c).getComponent(cc.Label),console.log("replace my head ......"),o.changeSpriteFrameWithServerUrl(h._meHead,G.me.avatarUrl+"?aaa=aa.jpg"),h._myName.string=G.me.nickName,h._myScore.string=G.me.score,console.log("add touch event ......"),h._cancelButton.on("click",n.onCancelClicked,n),h._roomId=e.roomId,s.isNullOrUndefined(e.opponent)?(h._confirmButton.targetOff(n),h._confirmButton.on("click",n.onInviteClicked,n)):(console.log("changing head"),o.changeSpriteFrameWithServerUrl(h._opponentHead,e.opponent.avatarUrl+"?aaa=aa.jpg"),h._opponentsName.string=e.opponent.nickName,h._opponentsScore.string=e.opponent.score,console.log("changing button"),n.changeConfirmButton(i.START),h._confirmButton.targetOff(n),h._confirmButton.on("click",n.onStartGame,n)),h._room.parent=cc.find("Canvas"),console.log("room fade in ......"),n.startFadeIn(),console.log("room config ......"),n.configRoom()}}),n.playClickAudio=function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(u.click,cc.AudioClip))},n.configRoom=function(){},n.startFadeIn=function(){cc.eventManager.pauseTarget(h._room,!0),h._room.position=cc.p(0,0),h._room.setScale(2),h._room.opacity=0,h._room.runAction(n.actionFadeIn)},n.startFadeOut=function(){cc.eventManager.pauseTarget(h._room,!0),h._room.runAction(n.actionFadeOut)},n.onFadeInFinish=function(){cc.eventManager.resumeTarget(h._room,!0)},n.onFadeOutFinish=function(){n.onDestory()},n.onDestory=function(){h._room.destroy(),h._room=null,h._meHead=null,h._cancelButton=null,h._opponentHead=null,h._animSpeed=.3,h._myName=null,h._myScore=null,h._opponentsName=null,h._opponentsScore=null},n.onCancelClicked=function(){n.playClickAudio(),G.index.emit("QuitRoom",{})},n.onInviteClicked=function(){console.log("roomId == "+h._roomId),n.playClickAudio(),wx.shareAppMessage({title:"\u79f0\u96c4\u57ce\u5821\uff0c\u4f60\u51ed\u4ec0\u4e48\u8ddf\u6211\u6253\uff1f",imageUrl:u.share_1,query:"roomId="+h._roomId,success:function(e){console.log("\u8f6c\u53d1\u6210\u529f!!!"),null==e.shareTickets||void 0==e.shareTickets||""==e.shareTickets?console.log("res.shareTickets is null"):(console.log("res.shareTickets is not null"),e.shareTickets.length>0&&console.log("\u53ef\u6267\u884c\u7fa4\u5206\u4eab\u6210\u529f\u64cd\u4f5c"))},fail:function(e){console.log("\u8f6c\u53d1\u5931\u8d25!!!")}})},n.onStartGame=function(){n.playClickAudio(),G.index.emit("StartRoomGame",{})},G.index.on("SomeoneJoinRoom",function(e){G.index.request({url:c+"/room",success:function(e){if(console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code)1==e.data.code?l.showClearError():l.showSysError();else{var t=e.data.data;s.isNullOrUndefined(t)||s.isNullOrUndefined(t.me)||s.isNullOrUndefined(t.roomId)||s.isNullOrUndefined(t.opponent)||(G.opponent=t.opponent,o.changeSpriteFrameWithServerUrl(h._opponentHead,t.opponent.avatarUrl+"?aaa=aa.jpg"),h._opponentsName.string=t.opponent.nickName,h._opponentsScore.string=t.opponent.score,n.changeConfirmButton(i.START),h._confirmButton.targetOff(n),h._confirmButton.on("click",n.onStartGame,n))}},fail:function(e){console.log(e)}})}),G.index.on("GameStart",function(e){console.log("\u6e38\u620f\u5f00\u59cb\uff1a",e),G.gameType=a.FRIEND,0===e.pos?G.stand=d.BLACK:1===e.pos&&(G.stand=d.WHITE),G.roomId=e.roomId,n.startFadeOut(),cc.director.loadScene("game")}),G.index.on("SomeoneQuitRoom",function(e){console.log("SomeoneQuitRoom, res => ",e),o.changeSpriteFrame(h._opponentHead,"textures/Hall/head_unknown"),h._opponentsName.string="\u2014 \u2014",h._opponentsScore.string="- - - -",n.changeConfirmButton(i.FRIEND),h._confirmButton.targetOff(n),h._confirmButton.on("click",n.onInviteClicked,n)}),G.index.on("QuitRoomSuccess",function(){n.startFadeOut()}),G.index.on("QuitRoomError",function(e){console.error("\u9000\u51fa\u623f\u95f4\u5931\u8d25\uff1a",e.error),n.startFadeOut()}),G.index.on("StartRoomGameError",function(e){console.error("\u51c6\u5907\u6e38\u620f\u5931\u8d25\uff1a",e.error),l.showSysError()}),G.index.on("StartRoomGameSuccess",function(e){n.changeConfirmButton(i.WAITING),h._confirmButton.targetOff(n),h._confirmButton.on("click",function(){},n)}),n.changeConfirmButton=function(e){e===i.FRIEND?o.changeSpriteFrame(h._confirmButtonFont,"textures/Font/font_friends"):e===i.START?o.changeSpriteFrame(h._confirmButtonFont,"textures/Font/font_start"):e===i.WAITING&&o.changeSpriteFrame(h._confirmButtonFont,"textures/Font/font_waiting")})}};n.exports={createRoom:h.createRoom};cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],ShaderLiuGuang:[function(e,n,t){"use strict";cc._RF.push(n,"5373683rk5LT5d0dGGdH3xE","ShaderLiuGuang");var o=e("../util/bright_vert.js"),r=e("../util/bright_frag.js");cc.Class({extends:cc.Component,properties:{_time:0},onLoad:function(){this._time=0,this._sin=0,this._use()},_use:function(){this._program=new cc.GLProgram,this._program.initWithString(o,r),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),this._program.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS),this._program.link(),this._program.updateUniforms(),this._program.use(),this.updateGLParameters(),gl.uniform1f(this._program.getUniformLocationForName("sys_time"),this._time),this.setProgram(this.node._sgNode,this._program)},update:function(e){this._time+=2*e,this._program&&(this._program.use(),this._sin=10*Math.sin(this._time),this._sin>=9.9&&(this._sin=0,this._time=0),this._sin=Math.ceil(this._sin),gl.uniform1f(this._program.getUniformLocationForName("sys_time"),this._sin))},updateGLParameters:function(){this._time=Math.sin(Date.now())},setProgram:function(e,n){e.setShaderProgram(n);var t=e.children;if(t)for(var o=0;o<t.length;o++)this.setProgram(t[o],n)}}),cc._RF.pop()},{"../util/bright_frag.js":"bright_frag","../util/bright_vert.js":"bright_vert"}],Share:[function(e,n,t){"use strict";cc._RF.push(n,"e2528PDmYtDvJTTPDCV+0PO","Share");var o=e("Constants"),r=o.RESOURCES,c=e("UnitTools"),a=o.CLOUD_URL,i=e("CreatorHelper"),s=e("Common"),l={_share:null,_box:null,_red:null,_yellow:null,_blue:null,_redBtn:null,_yellowBtn:null,_blueBtn:null,_shareBtn:null,_redFinish:!1,_yellowFinish:!1,_blueFinish:!1,_shareCount:0,_quitButton:null,_animSpeed:.3,show:function(e,n,t){var o=this;void 0!=l._share&&(l._share=null),l._animSpeed=t||l._animSpeed,cc.loader.loadRes("prefabs/Share",cc.Prefab,function(e,n){if(e)cc.error(e);else{var t=cc.instantiate(n);l._share=t;var r=cc.callFunc(o.onFadeOutFinish,o),c=cc.callFunc(o.onFadeInFinish,o);o.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(l._animSpeed,255),cc.scaleTo(l._animSpeed,1)),c),o.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(l._animSpeed,0),cc.scaleTo(l._animSpeed,2)),r),l._quitButton=cc.find("shareBackground/quitButton",t),l._box=cc.find("shareBackground/box",t),l._red=cc.find("shareBackground/red",t),l._yellow=cc.find("shareBackground/yellow",t),l._blue=cc.find("shareBackground/blue",t),l._redBtn=cc.find("shareBackground/red/redBtn",t),l._yellowBtn=cc.find("shareBackground/yellow/yellowBtn",t),l._blueBtn=cc.find("shareBackground/blue/blueBtn",t),l._shareBtn=cc.find("shareBackground/shareBtn",t),l._quitButton.on("click",o.onButtonClicked,o),l._share.parent=cc.find("Canvas"),o.loadShare(),o.startFadeIn()}}),o.startFadeIn=function(){cc.eventManager.pauseTarget(l._share,!0),l._share.position=cc.p(0,0),l._share.setScale(2),l._share.opacity=0,l._share.runAction(o.actionFadeIn)},o.startFadeOut=function(){cc.eventManager.pauseTarget(l._share,!0),l._share.runAction(o.actionFadeOut)},o.onFadeInFinish=function(){cc.eventManager.resumeTarget(l._share,!0)},o.onFadeOutFinish=function(){o.onDestory()},o.onButtonClicked=function(e){o.playClickAudio(),o.startFadeOut()},o.onDestory=function(){l._share.destroy(),l._share=null,l._quitButton=null,l._box=null,l._red=null,l._yellow=null,l._blue=null,l._redBtn=null,l._yellowBtn=null,l._blueBtn=null,l._shareBtn=null,l._redFinish=null,l._yellowFinish=null,l._blueFinish=null,l._shareCount=0,l._animSpeed=.3},o.playClickAudio=function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))},o.changeRed=function(){i.changeSpriteFrame(o._red.getComponent(cc.Sprite),"textures/Notice/jdt_red"),l._redBtn.targetOff(o),l._redBtn.on("click",o.onRedKeyClick,o)},o.changeYellow=function(){i.changeSpriteFrame(o._yellow.getComponent(cc.Sprite),"textures/Notice/jdt_yellow"),l._yellow.targetOff(o),l._yellowBtn.on("click",o.onYellowKeyClick,o)},o.changeBlue=function(){i.changeSpriteFrame(o._blue.getComponent(cc.Sprite),"textures/Notice/jdt_blue"),l._blue.targetOff(o),l._blueBtn.on("click",o.onBlueKeyClick,o)},o.openBox=function(){o.playClickAudio(),wx.getUserCloudStorage({keyList:[G.gameShareId],success:function(e){console.log("getUserCloudStorage","success",e);var n=null!=e.KVDataList.length?e.KVDataList[0].value:null;if(n){var t=n.split("_"),r=t[0],i=t[1],u=t[2];new Date(r).toDateString()===(new Date).toDateString()&&!u&&i>=3&&l._redFinish&&l._yellowFinish&&l._blueFinish&&G.index.request({url:a+"/addCoin",method:"POST",data:{coin:300},success:function(e){console.log(e),c.isNullOrUndefined(e.data)||0!=e.data.code?s.showSysError():0===e.data.data.code?(o.closeBox(),o.submitShareInfo(1),o.refreshCoin()):1===e.data.data.code&&s.showSysError()},fail:function(){s.showSysError()}})}},fail:function(e){console.log("getUserCloudStorage","fail")},complete:function(e){console.log("getUserCloudStorage","ok")}})},o.refreshCoin=function(){G.index.request({url:a+"/player",success:function(e){if(console.log(e),c.isNullOrUndefined(e.data)||0!=e.data.code)s.showSysError();else{var n=e.data.data;c.isNullOrUndefined(n)?s.showSysError():(G.menuManager.coin.string=n.coin,s.showShareCoinSuccess())}},fail:function(){s.showSysError()}})},o.closeBox=function(){i.changeSpriteFrame(o._box.getComponent(cc.Sprite),"textures/Notice/xiangzi1"),l._box.targetOff(o)},o.loadShare=function(){wx.getUserCloudStorage({keyList:[G.gameShareId],success:function(e){console.log("getUserCloudStorage","success",e);var n=null!=e.KVDataList.length?e.KVDataList[0].value:null;if(n){var t=n.split("_"),r=(t[0],t[1]);t[2];switch(r){case"1":o.changeRed();break;case"2":o.changeRed(),o.changeYellow();break;case"3":o.changeRed(),o.changeYellow(),o.changeBlue()}}},fail:function(e){console.log("getUserCloudStorage","fail")},complete:function(e){console.log("getUserCloudStorage","ok")}})},o.onShareClick=function(){wx.shareAppMessage({title:"\u79f0\u96c4\u57ce\u5821\uff0c\u4f60\u51ed\u4ec0\u4e48\u8ddf\u6211\u6253\uff1f",imageUrl:r.share_1,success:function(e){switch(console.log("\u8f6c\u53d1\u6210\u529f!!!"),null==e.shareTickets||void 0==e.shareTickets||""==e.shareTickets?console.log("res.shareTickets is null"):(console.log("res.shareTickets is not null"),e.shareTickets.length>0&&console.log("\u53ef\u6267\u884c\u7fa4\u5206\u4eab\u6210\u529f\u64cd\u4f5c")),l._shareCount++,l._shareCount){case 1:o.changeRed();break;case 2:o.changeYellow();break;case 3:o.changeRed(),o.changeYellow(),o.changeBlue()}l._shareCount<=3&&o.submitShareInfo(0)},fail:function(){console.log("\u8f6c\u53d1\u5931\u8d25!!!")}})},o.onRedKeyClick=function(){o.playClickAudio(),o._redFinish||(o._redFinish=!0,s.showUseShareKeySuccess(),o._redBtn.getComponent(cc.Sprite).spriteFrame=null,o._redFinish&&o._yellowFinish&&o._blueFinish&&l._box.on("click",o.openBox,o))},o.onYellowKeyClick=function(){o.playClickAudio(),o._yellowFinish||(o._yellowFinish=!0,s.showUseShareKeySuccess(),o._yellowBtn.getComponent(cc.Sprite).spriteFrame=null,o._redFinish&&o._yellowFinish&&o._blueFinish&&l._box.on("click",o.openBox,o))},o.onBlueKeyClick=function(){o.playClickAudio(),o._blueFinish||(o._blueFinish=!0,s.showUseShareKeySuccess(),o._blueBtn.getComponent(cc.Sprite).spriteFrame=null,o._redFinish&&o._yellowFinish&&o._blueFinish&&l._box.on("click",o.openBox,o))},o.submitShareInfo=function(e){wx.getUserCloudStorage({keyList:[G.gameShareId],success:function(n){console.log("getUserCloudStorage","success",n);var t=null!=n.KVDataList.length?n.KVDataList[0].value:null;if(t){var o=t.split("_"),r=o[0],c=o[1],a=o[2];if(new Date(r).toDateString()===(new Date).toDateString()&&(a||c>=3))console.log("setUserCloudStorage","fail",a,c);else{c++;var i=(new Date).getTime();wx.setUserCloudStorage({KVDataList:[{key:G.gameShareId,value:i+"_"+c+"_"+e}],success:function(e){console.log("setUserCloudStorage","success",e)},fail:function(){console.log("setUserCloudStorage","fail")},complete:function(){console.log("setUserCloudStorage","ok")}})}}},fail:function(e){console.log("getUserCloudStorage","fail")},complete:function(e){console.log("getUserCloudStorage","ok")}})}}};n.exports={show:l.show};cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],ShopItem:[function(e,n,t){"use strict";cc._RF.push(n,"34253toKSZEert4FPEcUMKQ","ShopItem");var o=e("Constants"),r=o.SHOP_ITEM_STATUS,c=o.SKIN_TYPE,a=o.CHESS_SKIN,i=o.RESOURCES,s=e("UnitTools"),l=o.CLOUD_URL,u=e("Alert"),d=e("Common"),h=e("CreatorHelper");cc.Class({extends:cc.Component,properties:{background:cc.Sprite,cost:cc.Node,costIcon:cc.Node,costBg:cc.Node,ownedBg:cc.Node,nameBg:cc.Node,skin:cc.Node,_type:r.COIN,_cost:0,_skinOwned:!1,_skin:0},onLoad:function(){},refresh:function(){switch(this._type){case r.COIN:this.costBg.active=!0,this.ownedBg.active=!1,h.changeSpriteFrame(this.costIcon.getComponent(cc.Sprite),"textures/Shop/pic_jb"),this._skinOwned=!1;break;case r.DIAMOND:this.costBg.active=!0,this.ownedBg.active=!1,h.changeSpriteFrame(this.costIcon.getComponent(cc.Sprite),"textures/Shop/pic_zs"),this._skinOwned=!1;break;case r.OWNED:case r.USING:this.costBg.active=!1,this.ownedBg.active=!0,this._skinOwned=!0}switch(this._skin){case a.GREEN_DRAGON:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(this._skinOwned?i.gray_green_dragon:i.green_dragon,cc.SpriteFrame));break;case a.CAT_MAGE:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(this._skinOwned?i.gray_cat_mage:i.cat_mage,cc.SpriteFrame));break;case a.BLUE_SHEEP:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(this._skinOwned?i.gray_blue_sheep:i.blue_sheep,cc.SpriteFrame));break;case a.PURPLE_SHEEP:this.skin.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(this._skinOwned?i.gray_purple_sheep:i.purple_sheep,cc.SpriteFrame))}this._skinOwned?this.background.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.chess_owned_bg,cc.SpriteFrame)):(this.background.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(cc.loader.getRes(i.chess_common_bg,cc.SpriteFrame)),this.cost.getComponent(cc.Label).string=this._cost,this.skin.on("click",this.purchase,this))},init:function(e,n,t){console.log(e,n,t);this._type=e,this._skin=n,this._type!==r.OWNED&&this._type!==r.USING?(this._cost=t,this._skinOwned=!1):this._skinOwned=!0,this.refresh()},purchase:function(){var e=this;u.show("\u786e\u8ba4\u8d2d\u4e70\u8be5\u76ae\u80a4\u5417\uff1f",function(){G.index.request({url:l+"/purchaseItem",method:"POST",data:{data:{itemType:c.CHESS,itemId:e._skin}},success:function(e){console.log(e),s.isNullOrUndefined(e.data)||0!=e.data.code?d.showSysError():0===e.data.data.code?G.shopManager.loadChessData(1):1===e.data.data.code?u.show("\u91d1\u5e01\u4e0d\u8db3!",null,!1):2===e.data.data.code&&d.showSysError()},fail:function(){d.showSysError()}})},!0)}}),cc._RF.pop()},{Alert:"Alert",Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],ShopManager:[function(e,n,t){"use strict";cc._RF.push(n,"561b4iMyiZOQINFNFiZpZJL","ShopManager");var o=e("Constants"),r=o.RESOURCES,c=o.CLOUD_URL,a=e("UnitTools"),i=o.CHESS_SKIN,s=o.BOARD_SKIN,l=e("CreatorHelper"),u=o.SHOP_ITEM_STATUS,d=o.SCENE,h=e("Alert");cc.Class({extends:cc.Component,properties:{shopContent:cc.Node,shopItem:cc.Prefab,bigShopItem:cc.Prefab,chessTab:cc.Node,boardTab:cc.Node,chessTabLabel:cc.Node,boardTabLabel:cc.Node,closeBtn:cc.Node,_chessList:null,_boardList:null,coinNumber:cc.Label},onLoad:function(){G.currentScene=d.SHOP;this._chessList=[{itemId:i.GREEN_DRAGON,price:1e3},{itemId:i.CAT_MAGE,price:1e3},{itemId:i.BLUE_SHEEP,price:2e3},{itemId:i.PURPLE_SHEEP,price:2e3}],this._boardList=[{itemId:s.PURPLE,price:1e3}],G.shopManager=this,this.loadChessData()},onShopClose:function(){cc.director.loadScene("menu")},onBagShow:function(){cc.director.loadScene("bag")},onChessTabClick:function(){this.playClickAudio(),this.loadChessData()},onBoardTabClick:function(){this.playClickAudio(),this.loadBoardData()},playClickAudio:function(){G.music&&cc.audioEngine.playEffect(cc.loader.getRes(r.click,cc.AudioClip))},loadChessData:function(e){var n=this;n.shopItem&&G.index.request({url:c+"/player",success:function(t){if(console.log(t),!a.isNullOrUndefined(t.data)&&0==t.data.code){var o=t.data.data;if(!a.isNullOrUndefined(o)){G.me=o,G.playerCache=!0,n.shopContent.removeAllChildren(),l.changeSpriteFrame(n.chessTab.getComponent(cc.Sprite),"textures/Shop/btn_yellow"),l.changeSpriteFrame(n.boardTab.getComponent(cc.Sprite),"textures/Shop/btn_red"),l.changeSpriteFrame(n.chessTabLabel.getComponent(cc.Sprite),"textures/Shop/btn_yellow_qz"),l.changeSpriteFrame(n.boardTabLabel.getComponent(cc.Sprite),"textures/Shop/btn_red_qp");var r=o.chesses,c=0;for(var i in n._chessList){var s=!1;if(!a.isNullOrUndefined(r))for(var d in r)if(n._chessList[i].itemId===r[d].itemId){s=!0;var p=cc.instantiate(n.shopItem);r[d].isActive?p.getComponent("ShopItem").init(u.USING,n._chessList[i].itemId):p.getComponent("ShopItem").init(u.OWNED,n._chessList[i].itemId),n.shopContent.addChild(p),c++}if(!s)(p=cc.instantiate(n.shopItem)).getComponent("ShopItem").init(u.COIN,n._chessList[i].itemId,n._chessList[i].price),n.shopContent.addChild(p),c++}var g=c%3==0?0:1,f=parseInt(c/3)+g;console.log("row == "+f),n.shopContent.height=330*f,n.coinNumber.string=o.coin,a.isNullOrUndefined(e)&&1===e&&h.show("\u8d2d\u4e70\u6210\u529f!",null,!1)}}}})},loadBoardData:function(e){var n=this;n.shopItem&&G.index.request({url:c+"/player",success:function(t){if(console.log(t),!a.isNullOrUndefined(t.data)&&0==t.data.code){var o=t.data.data;if(!a.isNullOrUndefined(o)){G.me=o,G.playerCache=!0,n.shopContent.removeAllChildren(),l.changeSpriteFrame(n.chessTab.getComponent(cc.Sprite),"textures/Shop/btn_red"),l.changeSpriteFrame(n.boardTab.getComponent(cc.Sprite),"textures/Shop/btn_yellow"),l.changeSpriteFrame(n.chessTabLabel.getComponent(cc.Sprite),"textures/Shop/btn_red_qz"),l.changeSpriteFrame(n.boardTabLabel.getComponent(cc.Sprite),"textures/Shop/btn_yellow_qp");var r=o.boards,c=0;for(var i in n._boardList){var s=!1;if(!a.isNullOrUndefined(r))for(var d in r)if(n._boardList[i].itemId===r[d].itemId){s=!0;var p=cc.instantiate(n.bigShopItem);r[d].isActive?p.getComponent("BigShopItem").init(u.USING,n._boardList[i].itemId):p.getComponent("BigShopItem").init(u.OWNED,n._boardList[i].itemId),n.shopContent.addChild(p),c++}if(!s)(p=cc.instantiate(n.bigShopItem)).getComponent("BigShopItem").init(u.COIN,n._boardList[i].itemId,n._boardList[i].price),n.shopContent.addChild(p),c++}}var g=c;console.log("row == "+g),n.shopContent.height=330*g,n.coinNumber.string=o.coin,a.isNullOrUndefined(e)&&1===e&&h.show("\u8d2d\u4e70\u6210\u529f!",null,!1)}}})}}),cc._RF.pop()},{Alert:"Alert",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],ShowInfo:[function(e,n,t){"use strict";cc._RF.push(n,"064b4S6Bd5KT6I3wG6cdUcC","ShowInfo");var o=e("Constants"),r=o.INFO_TYPE,c=o.TITLE_TYPE,a=o.GAME_TYPE,i=e("UnitTools"),s=o.SCENE,l=o.CLOUD_URL,u=o.SERVER_GAME_RESULT,d=e("Common"),h=e("CreatorHelper"),p=o.STAND,g={_info:null,_callBack:null,_animSpeed:.3,_touchBack:null,_playAgain:null,_winnerHead:null,_winnerName:null,_winnerScore:null,_loserHead:null,_loserName:null,_loserScore:null,_winBg:null,_loseBg:null,show:function(e,n,t){var o=this;void 0!=g._info&&(g._info=null),cc.loader.loadRes("prefabs/Info",cc.Prefab,function(p,f){if(p)cc.error(p);else{var m=c.NONE;switch(e){case r.SETTLEMENT:G.index.request({url:l+"/settlement",success:function(t){if(console.log("settlement response => ",t),G.playerCache=!1,i.isNullOrUndefined(t.data)||0!=t.data.code)d.showSysError();else{var r=t.data.data;if(i.isNullOrUndefined(r)||i.isNullOrUndefined(r.player)||i.isNullOrUndefined(r.opponent))d.showSysError();else{if(r.result===u.LOSS||r.result===u.DRAW)m=c.LOSE;else{if(r.result!==u.WIN)return void d.showSysError();m=c.WIN}if(r.scoreResult&&r.scoreResult.score&&r.scoreResult.scoreDelta){wx.postMessage({messageType:3,MAIN_MENU_NUM:G.gameId,score:r.scoreResult.score});var l=r.scoreResult.scoreDelta>0?"+":"-",p=cc.instantiate(f);g._info=p;var _=cc.callFunc(o.onFadeOutFinish,o),S=cc.callFunc(o.onFadeInFinish,o);switch(o.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(g._animSpeed,255),cc.scaleTo(g._animSpeed,1)),S),o.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(g._animSpeed,0),cc.scaleTo(g._animSpeed,2)),_),g._winnerHead=cc.find("winBg/winner/winnerMask/winnerHead",p),g._winnerName=cc.find("winBg/winner/winnerName",p),g._winnerScore=cc.find("winBg/winner/winnerScore",p),g._loserHead=cc.find("loserBg/loser/loserMask/loserHead",p),g._loserName=cc.find("loserBg/loser/loserName",p),g._loserScore=cc.find("loserBg/loser/loserScore",p),g._touchBack=cc.find("quitButton",p),g._playAgain=cc.find("restartButton",p),G.currentScene===s.GAME&&G.gameType!==a.MATCH&&G.gameType!==a.RANK&&G.gameType!==a.FRIEND||(g._playAgain.active=!1,g._touchBack.setPosition(0,g._touchBack.getPosition().y)),m){case c.WIN:h.changeSpriteFrameWithServerUrl(g._winnerHead.getComponent(cc.Sprite),r.player.avatarUrl+"?aaa=aa.jpg"),g._winnerName.getComponent(cc.Label).string=r.player.nickName,g._winnerScore.getComponent(cc.Label).string=l+r.scoreResult.score,h.changeSpriteFrameWithServerUrl(g._loserHead.getComponent(cc.Sprite),r.opponent.avatarUrl+"?aaa=aa.jpg"),g._loserName.getComponent(cc.Label).string=r.opponent.nickName,g._loserScore.getComponent(cc.Label).string=r.opponent.score;break;case c.LOSE:h.changeSpriteFrameWithServerUrl(g._loserHead.getComponent(cc.Sprite),r.player.avatarUrl+"?aaa=aa.jpg"),g._loserName.getComponent(cc.Label).string=r.player.nickName,g._loserScore.getComponent(cc.Label).string=l+r.scoreResult.score,h.changeSpriteFrameWithServerUrl(g._winnerHead.getComponent(cc.Sprite),r.opponent.avatarUrl+"?aaa=aa.jpg"),g._winnerName.getComponent(cc.Label).string=r.opponent.nickName,g._winnerScore.getComponent(cc.Label).string=r.opponent.score;break;case c.DISCONNECT:}g._touchBack.on("click",o.onClicked,o),g._playAgain.active&&g._playAgain.on("click",o.onPlayAgain,o),g._info.parent=cc.find("Canvas"),o.startFadeIn(),o.configAlert(e,"",n)}else d.showSysError()}}},fail:function(e){console.log(e),d.showSysError()}});break;case r.DISCONNECT:break;case r.ROBOT:console.log("rb_settlement =>",t),t.result===u.LOSS||t.result===u.DRAW?m=c.LOSE:t.result===u.WIN?m=c.WIN:d.showSysError();var _=cc.instantiate(f);g._info=_;var S=cc.callFunc(o.onFadeOutFinish,o),C=cc.callFunc(o.onFadeInFinish,o);switch(o.actionFadeIn=cc.sequence(cc.spawn(cc.fadeTo(g._animSpeed,255),cc.scaleTo(g._animSpeed,1)),C),o.actionFadeOut=cc.sequence(cc.spawn(cc.fadeTo(g._animSpeed,0),cc.scaleTo(g._animSpeed,2)),S),g._winnerHead=cc.find("winBg/winner/winnerMask/winnerHead",_),g._winnerName=cc.find("winBg/winnerName",_),g._winnerScore=cc.find("winBg/winnerScore",_),g._loserHead=cc.find("loseBg/loser/loserMask/loserHead",_),g._loserName=cc.find("loseBg/loserName",_),g._loserScore=cc.find("loseBg/loserScore",_),g._touchBack=cc.find("quitButton",_),g._playAgain=cc.find("restartButton",_),g._winBg=cc.find("winBg",_),g._loseBg=cc.find("loseBg",_),G.currentScene===s.GAME&&G.gameType!==a.MATCH&&G.gameType!==a.RANK&&G.gameType!==a.FRIEND||(g._playAgain.active=!1,g._touchBack.setPosition(0,g._touchBack.getPosition().y)),m){case c.WIN:g._winBg.setPosition(0,g._winBg.getPosition().y),g._loseBg.active=!1,h.changeSpriteFrameWithServerUrl(g._winnerHead.getComponent(cc.Sprite),G.me.avatarUrl+"?aaa=aa.jpg"),g._winnerName.getComponent(cc.Label).string=G.me.nickName,g._winnerScore.getComponent(cc.Label).string=t.score;break;case c.LOSE:g._loseBg.setPosition(0,g._loseBg.getPosition().y),g._winBg.active=!1,h.changeSpriteFrameWithServerUrl(g._loserHead.getComponent(cc.Sprite),G.me.avatarUrl+"?aaa=aa.jpg"),g._loserName.getComponent(cc.Label).string=G.me.nickName,g._loserScore.getComponent(cc.Label).string=t.score;break;case c.DISCONNECT:}g._touchBack.on("click",o.onClicked,o),i.isNullOrUndefined(g._playAgain)||g._playAgain.on("click",o.onPlayAgain,o),g._info.parent=cc.find("Canvas"),o.startFadeIn(),o.configAlert(e,"",n)}}}),o.configAlert=function(e,n,t){g._callBack=t,console.log("_callBack",g._callBack)},o.startFadeIn=function(){cc.eventManager.pauseTarget(g._alert,!0),g._info.position=cc.p(0,0),g._info.setScale(2),g._info.opacity=0,g._info.runAction(o.actionFadeIn)},o.startFadeOut=function(){cc.eventManager.pauseTarget(g._info,!0),g._info.runAction(o.actionFadeOut)},o.onFadeInFinish=function(){cc.eventManager.resumeTarget(g._info,!0)},o.onFadeOutFinish=function(){o.onDestory()},o.onPlayAgain=function(){G.stand=p.BLACK,G.gameType=a.ROBOT,cc.director.loadScene("game")},o.onClicked=function(){g._callBack&&g._callBack(),o.startFadeOut()},o.onDestory=function(){g._info.destroy(),g._callBack=null,g._info=null,g._animSpeed=.3,g._touchBack=null,g._playAgain=null,g._winnerHead=null,g._winnerName=null,g._winnerScore=null,g._loserHead=null,g._loserName=null,g._loserScore=null,g._winBg=null,g._loseBg=null}}};n.exports={show:g.show};cc._RF.pop()},{Common:"Common",Constants:"Constants",CreatorHelper:"CreatorHelper",UnitTools:"UnitTools"}],Turn:[function(e,n,t){"use strict";cc._RF.push(n,"45962/JFlBKc4w1ydi8klnX","Turn"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],UnitTools:[function(e,n,t){"use strict";cc._RF.push(n,"608bfVbMSRLQbhnNW3c8nKk","UnitTools");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(){}r.isNullOrUndefined=function(e){return void 0===e||null==e},r.isUndefined=function(e){return void 0===e},r.isFunction=function(e){return"function"==typeof e},r.isJson=function(e){return"object"==(void 0===e?"undefined":o(e))},r.isArray=function(e){return e instanceof Array},r.getJsonKeys=function(e){if(0==r.isJson(e))throw new Error("getJsonKeys must be json");var n=[];for(var t in e)n.push(t);return n},r.getJsonValues=function(e){if(0==r.isJson(e))throw new Error("getJsonvalues must be json");var n=[];for(var t in e)n.push(e[t]);return n},r.getJsonValues=function(e){try{return e()}catch(e){return null}},r.getJsonLength=function(e){if(0==r.isJson(e))throw new Error("getJsonLength must be json");var n=0;for(var t in e)n+=1;return n},r.getOrCreateArrayInJson=function(e,n){if(!1===r.isJson(n))return null;var t=n[e];return!1===r.isArray(t)&&(t=n[e]=[]),t},r.getOrCreateJsonInJson=function(e,n){if(!1===r.isJson(n))return null;var t=n[e];return!1===r.isJson(t)&&(t=n[e]={}),t},r.jsonToArray=function(e,n){if(0==r.isJson(e))return[];var t=[];for(var o in e)t.push(e[o]);return 0==r.isFunction(n)?t:(t.sort(n),t)},r.hasKey=function(e,n){return!r.isUndefined(e[n])},r.arrayHasValue=function(e,n){if(!r.isArray(n))return!1;for(var t in n){if(n[t]==e)return!0}return!1},r.getArrayValueIndex=function(e,n){if(!r.isArray(e))return-1;var t=-1;for(var o in e){if(n==e[o]){t=o;break}}return t},r.remove=function(e,n){delete e[n]},r.removeArray=function(e,n){r.isArray(e)&&r.isArray(n)&&r.forEach(n,function(n,t){var o=r.getArrayValueIndex(e,t);-1!=o&&e.splice(o,1)})},r.attachJson=function(e,n){r.isJson(e)&&r.isJson(n)&&r.forEach(n,function(n,t){e[n]=t})},r.forEach=function(e,n){if(0==r.isFunction(n))throw new Error("UnitTools.forEach itemCallback must be a function");if(r.isArray(e)||r.isJson(e))for(var t in e)n(t,e[t])},r.now=function(){return(new Date).getTime()},r.getFuncArgs=function(e){if(!r.isNullOrUndefined(e))return e.length},r.genID=function(){for(var e="",n=0;n<8;n++)e+=(65536*(1+Math.random())|0).toString(16).substring(1);return e.toLowerCase()},r.genShortID=function(){for(var e="",n=0;n<6;n++)e+=r.random(0,9);return e},r.isTimeOut=function(e,n){if(Date.now()-e>=n)return!0},r.formatStr=function(e){if(0==arguments.length)return null;e=arguments[0];for(var n=1;n<arguments.length;n++){var t=new RegExp("\\{"+(n-1)+"\\}","gm");e=e.replace(t,arguments[n])}return e},r.random=function(e,n){var t=n-e;return e+Math.floor(Math.random()*(t+1))},r.load=function(e,n,t){try{var o=!1;setTimeout(function(){0==o&&n(new Error("\u8d85\u65f6\u4e86"),null)},t);var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&r.status>=200&&r.status<400&&(o=!0,n(null,r.responseText))},r.open("GET",e,!0),r.send()}catch(e){n(e,null)}},r.request=function(e,n,t,o){var r="",c=!0;for(var a in n){c||(r+="&"),c=!1,r+=a,r+="=",r+=n[a]}try{var i=!1;setTimeout(function(){0==i&&t(new Error("\u8d85\u65f6\u4e86"),null)},o);var s=new XMLHttpRequest;s.onreadystatechange=function(){4==s.readyState&&s.status>=200&&s.status<400&&(i=!0,t(null,s.responseText))};var l=""==r?e:e+"?"+r;l=encodeURI(l),s.open("GET",l,!0),s.send()}catch(e){t(e,null)}},r.checkMobile=function(e){return!!/^1\d{10}$/.test(e)},r.checkSpecialChar=function(e){return!!/[~#^$@%&!*()<>:;'"{}\u3010\u3011  ]/gi.test(e)},r.changeToNum2=function(e){return 1==e.toString().length?"0"+e:e},r.base64=function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);return function(e){var t,o,r,c,a,i;for(r=e.length,o=0,t="";o<r;){if(c=255&e.charCodeAt(o++),o==r){t+=n.charAt(c>>2),t+=n.charAt((3&c)<<4),t+="==";break}if(a=e.charCodeAt(o++),o==r){t+=n.charAt(c>>2),t+=n.charAt((3&c)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2),t+="=";break}i=e.charCodeAt(o++),t+=n.charAt(c>>2),t+=n.charAt((3&c)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2|(192&i)>>6),t+=n.charAt(63&i)}return t}(e)},r.deBase64=function(e){var n=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);return function(e){var t,o,r,c,a,i,s;for(i=e.length,a=0,s="";a<i;){do{t=n[255&e.charCodeAt(a++)]}while(a<i&&-1==t);if(-1==t)break;do{o=n[255&e.charCodeAt(a++)]}while(a<i&&-1==o);if(-1==o)break;s+=String.fromCharCode(t<<2|(48&o)>>4);do{if(61==(r=255&e.charCodeAt(a++)))return s;r=n[r]}while(a<i&&-1==r);if(-1==r)break;s+=String.fromCharCode((15&o)<<4|(60&r)>>2);do{if(61==(c=255&e.charCodeAt(a++)))return s;c=n[c]}while(a<i&&-1==c);if(-1==c)break;s+=String.fromCharCode((3&r)<<6|c)}return s}(e)},n.exports=r,cc._RF.pop()},{}],bright_frag:[function(e,n,t){"use strict";cc._RF.push(n,"4eba5L0v6JNWJtve6Bm0AEM","bright_frag"),n.exports="\n#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec2 v_texCoord;\nuniform float sys_time;\nvoid main()\n{\n    vec4 src_color = texture2D(CC_Texture0, v_texCoord).rgba;\n\n    float width = 0.25;       //\u6d41\u5149\u7684\u5bbd\u5ea6\u8303\u56f4 (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u5bbd\u5ea6)\n    float start = sys_time/7.0;  //\u6d41\u5149\u7684\u8d77\u59cbx\u5750\u6807\n    float strength = 0.01;   //\u6d41\u5149\u589e\u4eae\u5f3a\u5ea6   (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u589e\u4eae\u5f3a\u5ea6)\n    float offset = 0.2;      //\u504f\u79fb\u503c         (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u503e\u659c\u7a0b\u5ea6)\n    //if( start <= v_texCoord.x && v_texCoord.x <= (start + width))\n    if( v_texCoord.x < (start - offset * v_texCoord.y) &&  v_texCoord.x > (start - offset * v_texCoord.y - width))\n    {\n        float center_l = (start - offset * v_texCoord.y - width) - (start - offset * v_texCoord.y);\n        center_l = abs(center_l);\n        float l = abs((start - offset * v_texCoord.y) - center_l/2.0 - v_texCoord.x);\n        float a = 5.0 * (center_l/2.0-l)/(center_l/2.0); // tony \u6d41\u5149\u4e2d\u5fc3\u5f3a\u5ea6\uff08\u53ea\u6709\u8c03\u6574\u8fd9\u4e2a\u503c\u624d\u4f1a\u751f\u6548\uff0c*\u524d\u9762\u7684\u6570\u503c\uff09\n        float strength = 0.005 * a;\n        if (strength < 0.00392) strength = 0.00392;\n        vec3 improve = strength * vec3(255, 100, 100); //\u989c\u8272\n        //tony \u4fdd\u8bc1\u4e0d\u53d8\u9ed1\n        if (improve.x < 1.0) improve.x = 1.0;\n        if (improve.y < 1.0) improve.y = 1.0;\n        if (improve.z < 1.0) improve.z = 1.0;\n        vec3 result = improve * vec3( src_color.r, src_color.g, src_color.b);\n        gl_FragColor = vec4(result, src_color.a);\n\n    }else{\n        gl_FragColor = src_color;\n    }\n}\n",cc._RF.pop()},{}],bright_vert:[function(e,n,t){"use strict";cc._RF.push(n,"9ed9d+i7RdChqDBqtzB4e2Y","bright_vert"),n.exports="\nattribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position = CC_PMatrix * a_position;\n    v_fragmentColor = a_color;\n    v_texCoord = a_texCoord;\n}\n",cc._RF.pop()},{}],constants:[function(e,n,t){"use strict";cc._RF.push(n,"e4702Szf4JFsZZKjQ3WINTi","constants"),n.exports={WX_HEADER_CODE:"X-WX-Code",WX_HEADER_ENCRYPTED_DATA:"X-WX-Encrypted-Data",WX_HEADER_IV:"X-WX-IV",WX_HEADER_ID:"X-WX-Id",WX_HEADER_SKEY:"X-WX-Skey",WX_SESSION_MAGIC_ID:"F2C224D4-2BCE-4C64-AF9F-A6D872000D1A",ERR_INVALID_PARAMS:"ERR_INVALID_PARAMS",ERR_WX_LOGIN_FAILED:"ERR_WX_LOGIN_FAILED",ERR_WX_GET_USER_INFO:"ERR_WX_GET_USER_INFO",ERR_LOGIN_TIMEOUT:"ERR_LOGIN_TIMEOUT",ERR_LOGIN_FAILED:"ERR_LOGIN_FAILED",ERR_LOGIN_SESSION_NOT_RECEIVED:"ERR_LOGIN_MISSING_SESSION",ERR_SESSION_INVALID:"ERR_SESSION_INVALID",ERR_CHECK_LOGIN_FAILED:"ERR_CHECK_LOGIN_FAILED"},cc._RF.pop()},{}],index:[function(e,n,t){"use strict";cc._RF.push(n,"bae27TTU5BInb30kKEfpvFa","index");var o=e("./lib/constants"),r=e("./lib/login"),c=e("./lib/session"),a=e("./lib/request"),i=e("./lib/tunnel"),s=n.exports={login:r.login,loginWithCode:r.loginWithCode,setLoginUrl:r.setLoginUrl,Session:c,clearSession:c.clear,request:a.request,RequestError:a.RequestError,Tunnel:i};Object.keys(o).forEach(function(e){0===e.indexOf("ERR_")&&(s[e]=o[e])}),cc._RF.pop()},{"./lib/constants":"constants","./lib/login":"login","./lib/request":"request","./lib/session":"session","./lib/tunnel":"tunnel"}],login:[function(e,n,t){"use strict";function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}cc._RF.push(n,"510f1+RrGRHl7rgQO2GJebz","login");var r=e("./constants"),c=e("./session");var a=function(){},i={method:"GET",success:a,fail:a,loginUrl:null};n.exports={login:function(e){if(!(e=Object.assign({},i,e)).loginUrl)return e.fail(new Error("\u767b\u5f55\u9519\u8bef\uff1a\u7f3a\u5c11\u767b\u5f55\u5730\u5740\uff0c\u8bf7\u901a\u8fc7 setLoginUrl() \u65b9\u6cd5\u8bbe\u7f6e\u767b\u5f55\u5730\u5740"));(function(e){wx.login({success:function(n){wx.getUserInfo({success:function(t){e(null,{code:n.code,encryptedData:t.encryptedData,iv:t.iv,userInfo:t.userInfo})},fail:function(n){e(new Error("\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u72b6\u6001"),null),console.log(n)}})},fail:function(n){e(new Error("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u72b6\u6001"),null),console.log(n)}})})(function(n,t){var a;if(n)return e.fail(n);var i=(o(a={},r.WX_HEADER_CODE,t.code),o(a,r.WX_HEADER_ENCRYPTED_DATA,t.encryptedData),o(a,r.WX_HEADER_IV,t.iv),a);wx.request({url:e.loginUrl,header:i,method:e.method,success:function(n){var t=n.data;if(!t||0!==t.code||!t.data||!t.data.skey)return e.fail(new Error("\u54cd\u5e94\u9519\u8bef\uff0c"+JSON.stringify(t)));var o=t.data;if(!o||!o.userinfo)return e.fail(new Error("\u767b\u5f55\u5931\u8d25("+t.error+")\uff1a"+t.message));c.set(o),e.success(o.userinfo)},fail:function(n){console.error("\u767b\u5f55\u5931\u8d25\uff0c\u53ef\u80fd\u662f\u7f51\u7edc\u9519\u8bef\u6216\u8005\u670d\u52a1\u5668\u53d1\u751f\u5f02\u5e38"),e.fail(n)}})})},setLoginUrl:function(e){i.loginUrl=e},loginWithCode:function(e){if(!(e=Object.assign({},i,e)).loginUrl)return e.fail(new Error("\u767b\u5f55\u9519\u8bef\uff1a\u7f3a\u5c11\u767b\u5f55\u5730\u5740\uff0c\u8bf7\u901a\u8fc7 setLoginUrl() \u65b9\u6cd5\u8bbe\u7f6e\u767b\u5f55\u5730\u5740"));wx.login({success:function(n){var t=o({},r.WX_HEADER_CODE,n.code);wx.request({url:e.loginUrl,header:t,method:e.method,success:function(n){var t=n.data;if(!t||0!==t.code||!t.data||!t.data.skey)return e.fail(new Error("\u7528\u6237\u672a\u767b\u5f55\u8fc7\uff0c\u8bf7\u5148\u4f7f\u7528 login() \u767b\u5f55"));var o=t.data;if(!o||!o.userinfo)return e.fail(new Error("\u767b\u5f55\u5931\u8d25("+t.error+")\uff1a"+t.message));c.set(o),e.success(o.userinfo)},fail:function(n){console.error("\u767b\u5f55\u5931\u8d25\uff0c\u53ef\u80fd\u662f\u7f51\u7edc\u9519\u8bef\u6216\u8005\u670d\u52a1\u5668\u53d1\u751f\u5f02\u5e38"),e.fail(n)}})}})}},cc._RF.pop()},{"./constants":"constants","./session":"session"}],request:[function(e,n,t){"use strict";cc._RF.push(n,"513b8ZjkwZI7rl+Kzdl4PFf","request");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e("./constants"),c=e("./utils"),a=e("./session"),i=e("./login"),s=function(){},l=function(e){var n={};return e&&(n[r.WX_HEADER_SKEY]=e),n},u=function(){function e(e,n){Error.call(this,n),this.type=e,this.message=n}return e.prototype=new Error,e.prototype.constructor=e,e}();n.exports={RequestError:u,request:function(e){if("object"!==(void 0===e?"undefined":o(e))){var n="\u8bf7\u6c42\u4f20\u53c2\u5e94\u4e3a object \u7c7b\u578b\uff0c\u4f46\u5b9e\u9645\u4f20\u4e86 "+(void 0===e?"undefined":o(e))+" \u7c7b\u578b";throw new u(r.ERR_INVALID_PARAMS,n)}var t=e.login,d=e.success||s,h=e.fail||s,p=e.complete||s,g=e.header||{},f=function(){d.apply(null,arguments),p.apply(null,arguments)},m=function(e){h.call(null,e),p.call(null,e)},_=!1;function S(){i.loginWithCode({success:C,fail:m})}function C(){var n={},t=a.get();t&&(n=l(t.skey)),wx.request(c.extend({},e,{header:c.extend({},g,n),success:function(e){var n,t,o=e.data;if(o&&-1===o.code||401===e.statusCode)return a.clear(),_?(t="\u767b\u5f55\u6001\u5df2\u8fc7\u671f",n=new u(o.error,t),void m(n)):(_=!0,void S());f.apply(null,arguments)},fail:m,complete:s}))}t?S():C()}},cc._RF.pop()},{"./constants":"constants","./login":"login","./session":"session","./utils":"utils"}],session:[function(e,n,t){"use strict";cc._RF.push(n,"cac0dW4R6xNmaHeqaKzmJLf","session");var o="weapp_session_"+e("./constants").WX_SESSION_MAGIC_ID,r={get:function(){return wx.getStorageSync(o)||null},set:function(e){wx.setStorageSync(o,e)},clear:function(){wx.removeStorageSync(o)}};n.exports=r,cc._RF.pop()},{"./constants":"constants"}],tunnel:[function(e,n,t){"use strict";cc._RF.push(n,"901dfpBexlGcY06CgI3d9TD","tunnel");var o=e("./request"),r=e("./wxTunnel"),c=e("../../../util/Map"),a=null,i=v.STATUS_CLOSED="CLOSED",s=v.STATUS_CONNECTING="CONNECTING",l=v.STATUS_ACTIVE="ACTIVE",u=v.STATUS_RECONNECTING="RECONNECTING",d=v.ERR_CONNECT_SERVICE=1001,h=(v.ERR_CONNECT_SOCKET=1002,v.ERR_RECONNECT=2001),p=v.ERR_SOCKET_ERROR=3001,g="message",f="ping",m="pong",_="timeout",S="close",C=5,T=1e3;function v(e){if(a&&a.status!==i)throw new Error("\u5f53\u524d\u6709\u672a\u5173\u95ed\u7684\u4fe1\u9053\uff0c\u8bf7\u5148\u5173\u95ed\u4e4b\u524d\u7684\u4fe1\u9053\uff0c\u518d\u6253\u5f00\u65b0\u4fe1\u9053");a=this;var n=this;function t(){return n.status===s}function E(){return n.status===l}function b(){return n.status===u}function y(e){n.status!==e&&(n.status=e)}this.serviceUrl=e,this.socketUrl=null,this.status=null,this.open=G,this.on=function(e,n){"function"==typeof n&&k.setKeyValue(e,n)},this.emit=function(e,n){B({type:g,content:{type:e,content:n}})},this.close=Q,this.isClosed=function(){return n.status===i},this.isConnecting=t,this.isActive=E,this.isReconnecting=b,y(i);var w="connect,close,reconnecting,reconnect,error".split(","),k=new c;function F(e,n){k.forEach(function(t,o){"*"===t?o(e,n):t===e&&o(n)})}var N=!0,R=!1;function G(){function t(e){N?(y(i),F("error",{code:d,message:"\u8fde\u63a5\u4fe1\u9053\u670d\u52a1\u5931\u8d25\uff0c\u7f51\u7edc\u9519\u8bef\u6216\u8005\u4fe1\u9053\u670d\u52a1\u6ca1\u6709\u6b63\u786e\u54cd\u5e94",detail:e||null})):J(e)}R||(R=!0,y(N?s:u),o.request({url:e,method:"GET",success:function(e){200==+e.statusCode&&e.data&&e.data.data.connectUrl?function(e){r.listen({onOpen:I,onMessage:A,onClose:X,onError:Z}),wx.connectSocket({url:e}),N=!1}(n.socketUrl=e.data.data.connectUrl):t(e)},fail:t,complete:function(){return R=!1}}))}var O=[];function I(){t()?F("connect"):b()&&(F("reconnect"),Y()),y(l),O.forEach(B),O.length=0,M()}function A(e){(function(e){var n=e.split(":"),t=n.shift(),o=n.join(":")||null,r={type:t};if(o)try{r.content=JSON.parse(o)}catch(e){}switch(r.type){case g:(function(e){var n=e.content;(function(e,n){w.indexOf(e)>-1&&(e="@"+e),F(e,n)})(n.type,n.content)})(r);break;case m:M();break;case _:(function(e){var n=1e3*e.content;isNaN(n)||(U=n,H())})(r);break;case S:Q()}})(e.data)}function B(e){E()?function(e){var n=[e.type];e.content&&n.push(JSON.stringify(e.content));wx.sendSocketMessage({data:n.join(":"),fail:Z})}(e):O.push(e)}var U=15e3,x=0,L=0;function M(){clearTimeout(x),clearTimeout(L),x=setTimeout(H,U)}function H(){E()&&(B({type:f}),L=setTimeout(D,U))}function D(){J("\u670d\u52a1\u5668\u5df2\u5931\u53bb\u54cd\u5e94")}var P=0,W=v.MAX_RECONNECT_TRY_TIMES||C,q=0,K=v.RECONNECT_TIME_INCREASE||T,j=0;function J(e){P>=W?(Q(),F("error",{code:h,message:"\u91cd\u8fde\u5931\u8d25",detail:e})):(wx.closeSocket(),q+=K,y(u),j=setTimeout(V,q)),0===P&&F("reconnecting"),P+=1}function V(){G()}function Y(){P=0,q=0}var z=!1;function X(){z||E()&&J("\u94fe\u63a5\u5df2\u65ad\u5f00")}function Q(){z=!0,function(e){E()&&!1!==e&&B({type:S});wx.closeSocket()}(),y(i),Y(),N=!1,clearTimeout(x),clearTimeout(L),clearTimeout(j),F("close"),z=!1}function Z(e){switch(n.status){case v.STATUS_CONNECTING:F("error",{code:p,message:"\u8fde\u63a5\u4fe1\u9053\u5931\u8d25\uff0c\u7f51\u7edc\u9519\u8bef\u6216\u8005\u4fe1\u9053\u670d\u52a1\u4e0d\u53ef\u7528",detail:e})}}}n.exports=v,cc._RF.pop()},{"../../../util/Map":"Map","./request":"request","./wxTunnel":"wxTunnel"}],utils:[function(e,n,t){"use strict";cc._RF.push(n,"828ecV6HmxO/ZyPt7OTu8rf","utils"),t.extend=function(e){for(var n=Array.prototype.slice.call(arguments,1),t=0;t<n.length;t+=1){var o=n[t];for(var r in o)o.hasOwnProperty(r)&&(e[r]=o[r])}return e},cc._RF.pop()},{}],wxTunnel:[function(e,n,t){"use strict";cc._RF.push(n,"e9fd8WoLLtPZaYstpUqM8fV","wxTunnel");var o=function(){},r=void 0,c=void 0,a=void 0,i=void 0;function s(e){e?(r=e.onOpen,c=e.onClose,a=e.onMessage,i=e.onError):(r=o,c=o,a=o,i=o)}s(null),wx.onSocketOpen(function(e){return r(e)}),wx.onSocketClose(function(e){return c(e)}),wx.onSocketMessage(function(e){return a(e)}),wx.onSocketError(function(e){return i(e)}),n.exports={listen:s},cc._RF.pop()},{}]},{},["BagItem","BigBagItem","BigShopItem","Chess","PreChess","ShopItem","Turn","index","constants","login","request","session","tunnel","utils","wxTunnel","ShaderLiuGuang","BagManager","ChessManager","GameManager","LoadManager","MenuManager","PreChessManager","RankManager","ShopManager","Alert","Common","Constants","CreatorHelper","EventEmitter","Global","MD5","Map","Match","Notice","Rank","Robot","Room","Share","ShowInfo","UnitTools","bright_frag","bright_vert"]);